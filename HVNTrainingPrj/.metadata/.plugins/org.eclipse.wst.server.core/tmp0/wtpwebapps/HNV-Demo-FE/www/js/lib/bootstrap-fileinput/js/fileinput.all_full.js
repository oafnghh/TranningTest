!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}((function(e){"use strict";var t,i;if(e.fn.fileinputLocales={},e.fn.fileinputThemes={},String.prototype.setTokens=function(e){var t,i,a=this.toString();for(t in e)e.hasOwnProperty(t)&&(i=new RegExp("{"+t+"}","g"),a=a.replace(i,e[t]));return a},t={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",OBJECT_PARAMS:'<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',DEFAULT_PREVIEW:'<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],objUrl:window.URL||window.webkitURL,compare:function(e,t,i){return void 0!==e&&(i?e===t:e.match(t))},isIE:function(e){if("Microsoft Internet Explorer"!==navigator.appName)return!1;if(10===e)return new RegExp("msie\\s"+e,"i").test(navigator.userAgent);var t,i=F.createElement("div");return i.innerHTML="\x3c!--[if IE "+e+"]> <i></i> <![endif]--\x3e",t=i.getElementsByTagName("i").length,F.body.appendChild(i),i.parentNode.removeChild(i),t},initModal:function(t){var i=e("body");i.length&&t.appendTo(i)},isEmpty:function(t,i){return null==t||0===t.length||i&&""===e.trim(t)},isArray:function(e){return Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)},ifSet:function(e,t,i){return i=i||"",t&&"object"==typeof t&&e in t?t[e]:i},cleanArray:function(e){return e instanceof Array||(e=[]),e.filter((function(e){return null!=e}))},spliceArray:function(e,t){var i,a=0,n=[];if(!(e instanceof Array))return[];for(i=0;i<e.length;i++)i!==t&&(n[a]=e[i],a++);return n},getNum:function(e,t){return t=t||0,"number"==typeof e?e:("string"==typeof e&&(e=parseFloat(e)),isNaN(e)?t:e)},hasFileAPISupport:function(){return!(!window.File||!window.FileReader)},hasDragDropSupport:function(){var e=F.createElement("div");return!t.isIE(9)&&(void 0!==e.draggable||void 0!==e.ondragstart&&void 0!==e.ondrop)},hasFileUploadSupport:function(){return t.hasFileAPISupport()&&window.FormData},hasBlobSupport:function(){try{return!!window.Blob&&Boolean(new Blob)}catch(e){return!1}},hasArrayBufferViewSupport:function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}},dataURI2Blob:function(e){var i,a,n,r,o,l,s=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,d=t.hasBlobSupport();if(!((d||s)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return null;for(i=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),a=new ArrayBuffer(i.length),n=new Uint8Array(a),r=0;r<i.length;r+=1)n[r]=i.charCodeAt(r);return o=e.split(",")[0].split(":")[1].split(";")[0],d?new Blob([t.hasArrayBufferViewSupport()?n:a],{type:o}):((l=new s).append(a),l.getBlob(o))},arrayBuffer2String:function(e){if(window.TextDecoder)return new TextDecoder("utf-8").decode(e);var t,i,a,n,r=Array.prototype.slice.apply(new Uint8Array(e)),o="",l=0;for(t=r.length;l<t;)switch((i=r[l++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:a=r[l++],o+=String.fromCharCode((31&i)<<6|63&a);break;case 14:a=r[l++],n=r[l++],o+=String.fromCharCode((15&i)<<12|(63&a)<<6|(63&n)<<0)}return o},isHtml:function(e){var t=F.createElement("div");t.innerHTML=e;for(var i=t.childNodes,a=i.length;a--;)if(1===i[a].nodeType)return!0;return!1},isSvg:function(e){return e.match(/^\s*<\?xml/i)&&(e.match(/<!DOCTYPE svg/i)||e.match(/<svg/i))},getMimeType:function(e,t,i){switch(e){case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":return"image/jpeg";case"89504E47":return"image/png";case"47494638":return"image/gif";case"49492a00":return"image/tiff";case"52494646":return"image/webp";case"66747970":return"video/3gp";case"4f676753":return"video/ogg";case"1a45dfa3":return"video/mkv";case"000001ba":case"000001b3":return"video/mpeg";case"3026b275":return"video/wmv";case"25504446":return"application/pdf";case"25215053":return"application/ps";case"504b0304":case"504b0506":case"504b0508":return"application/zip";case"377abcaf":return"application/7z";case"75737461":return"application/tar";case"7801730d":return"application/dmg";default:switch(e.substring(0,6)){case"435753":return"application/x-shockwave-flash";case"494433":return"audio/mp3";case"425a68":return"application/bzip";default:switch(e.substring(0,4)){case"424d":return"image/bmp";case"fffb":return"audio/mp3";case"4d5a":return"application/exe";case"1f9d":case"1fa0":return"application/zip";case"1f8b":return"application/gzip";default:return t&&!t.match(/[^\u0000-\u007f]/)?"application/text-plain":i}}}},addCss:function(e,t){e.removeClass(t).addClass(t)},getElement:function(i,a,n){return t.isEmpty(i)||t.isEmpty(i[a])?n:e(i[a])},uniqId:function(){return Math.round((new Date).getTime())+"_"+Math.round(100*Math.random())},htmlEncode:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(t,i){var a=t;return i?(e.each(i,(function(e,t){"function"==typeof t&&(t=t()),a=a.split(e).join(t)})),a):a},cleanMemory:function(e){var i=e.is("img")?e.attr("src"):e.find("source").attr("src");t.objUrl.revokeObjectURL(i)},findFileName:function(e){var t=e.lastIndexOf("/");return-1===t&&(t=e.lastIndexOf("\\")),e.split(e.substring(t,t+1)).pop()},checkFullScreen:function(){return F.fullscreenElement||F.mozFullScreenElement||F.webkitFullscreenElement||F.msFullscreenElement},toggleFullScreen:function(e){var i=F,a=i.documentElement;a&&e&&!t.checkFullScreen()?a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()},moveArray:function(e,t,i){if(i>=e.length)for(var a=i-e.length;1+a--;)e.push(void 0);return e.splice(i,0,e.splice(t,1)[0]),e},cleanZoomCache:function(e){var t=e.closest(".kv-zoom-cache-theme");t.length||(t=e.closest(".kv-zoom-cache")),t.remove()},setOrientation:function(e,t){var i,a,n=new DataView(e),r=0,o=1;if(65496!==n.getUint16(r)||e.length<2)t&&t();else{for(r+=2,i=n.byteLength;r<i-2;)switch(a=n.getUint16(r),r+=2,a){case 65505:i=n.getUint16(r)-r,r+=2;break;case 274:o=n.getUint16(r+6,!1),i=0}t&&t(o)}},validateOrientation:function(e,i){if(window.FileReader&&window.DataView){var a,n=new FileReader;n.onloadend=function(){a=n.result,t.setOrientation(a,i)},n.readAsArrayBuffer(e)}},adjustOrientedImage:function(e,t){var i;e.hasClass("is-portrait-gt4")&&(t?e.css({width:e.parent().height()}):(e.css({height:"auto",width:e.height()}),i=e.parent().offset().top-e.offset().top,e.css("margin-top",i)))},closeButton:function(e){return'<button type="button" class="'+(e=e?"close "+e:"close")+'" aria-label="Close">\n  <span aria-hidden="true">&times;</span>\n</button>'}},(i=function(i,a){var n=this;n.$element=e(i),n.$parent=n.$element.parent(),n._validate()&&(n.isPreviewable=t.hasFileAPISupport(),n.isIE9=t.isIE(9),n.isIE10=t.isIE(10),(n.isPreviewable||n.isIE9)&&(n._init(a),n._listen()),n.$element.removeClass("file-loading"))}).prototype={constructor:i,_cleanup:function(){var e=this;e.reader=null,e.formdata={},e.uploadCount=0,e.uploadStatus={},e.uploadLog=[],e.uploadAsyncCount=0,e.loadedImages=[],e.totalImagesCount=0,e.ajaxRequests=[],e.clearStack(),e.fileInputCleared=!1,e.fileBatchCompleted=!0,e.isPreviewable||(e.showPreview=!1),e.isError=!1,e.ajaxAborted=!1,e.cancelling=!1},_init:function(i,a){var n,r,o,l,s=this,d=s.$element;s.options=i,e.each(i,(function(e,i){switch(e){case"minFileCount":case"maxFileCount":case"minFileSize":case"maxFileSize":case"maxFilePreviewSize":case"resizeImageQuality":case"resizeIfSizeMoreThan":case"progressUploadThreshold":case"initialPreviewCount":case"zoomModalHeight":case"minImageHeight":case"maxImageHeight":case"minImageWidth":case"maxImageWidth":s[e]=t.getNum(i);break;default:s[e]=i}})),s.rtl&&(l=s.previewZoomButtonIcons.prev,s.previewZoomButtonIcons.prev=s.previewZoomButtonIcons.next,s.previewZoomButtonIcons.next=l),a||s._cleanup(),s.$form=d.closest("form"),s._initTemplateDefaults(),s.uploadFileAttr=t.isEmpty(d.attr("name"))?"file_data":d.attr("name"),o=s._getLayoutTemplate("progress"),s.progressTemplate=o.replace("{class}",s.progressClass),s.progressCompleteTemplate=o.replace("{class}",s.progressCompleteClass),s.progressErrorTemplate=o.replace("{class}",s.progressErrorClass),s.dropZoneEnabled=t.hasDragDropSupport()&&s.dropZoneEnabled,s.isDisabled=d.attr("disabled")||d.attr("readonly"),s.isDisabled&&d.attr("disabled",!0),s.isAjaxUpload=t.hasFileUploadSupport()&&!t.isEmpty(s.uploadUrl),s.isClickable=s.browseOnZoneClick&&s.showPreview&&(s.isAjaxUpload&&s.dropZoneEnabled||!t.isEmpty(s.defaultPreviewContent)),s.slug="function"==typeof i.slugCallback?i.slugCallback:s._slugDefault,s.mainTemplate=s.showCaption?s._getLayoutTemplate("main1"):s._getLayoutTemplate("main2"),s.captionTemplate=s._getLayoutTemplate("caption"),s.previewGenericTemplate=s._getPreviewTemplate("generic"),!s.imageCanvas&&s.resizeImage&&(s.maxImageWidth||s.maxImageHeight)&&(s.imageCanvas=F.createElement("canvas"),s.imageCanvasContext=s.imageCanvas.getContext("2d")),t.isEmpty(d.attr("id"))&&d.attr("id",t.uniqId()),s.namespace=".fileinput_"+d.attr("id").replace(/-/g,"_"),void 0===s.$container?s.$container=s._createContainer():s._refreshContainer(),r=s.$container,s.$dropZone=r.find(".file-drop-zone"),s.$progress=r.find(".kv-upload-progress"),s.$btnUpload=r.find(".fileinput-upload"),s.$captionContainer=t.getElement(i,"elCaptionContainer",r.find(".file-caption")),s.$caption=t.getElement(i,"elCaptionText",r.find(".file-caption-name")),t.isEmpty(s.msgPlaceholder)||(n=d.attr("multiple")?s.filePlural:s.fileSingle,s.$caption.attr("placeholder",s.msgPlaceholder.replace("{files}",n))),s.$captionIcon=s.$captionContainer.find(".file-caption-icon"),s.mainClass.indexOf("input-group-lg")>-1?t.addCss(s.$captionIcon,"icon-lg"):s.$captionIcon.removeClass("icon-lg"),s.$previewContainer=t.getElement(i,"elPreviewContainer",r.find(".file-preview")),s.$preview=t.getElement(i,"elPreviewImage",r.find(".file-preview-thumbnails")),s.$previewStatus=t.getElement(i,"elPreviewStatus",r.find(".file-preview-status")),s.$errorContainer=t.getElement(i,"elErrorContainer",s.$previewContainer.find(".kv-fileinput-error")),s._validateDisabled(),t.isEmpty(s.msgErrorClass)||0==s.showCapture&&t.addCss(s.$errorContainer,s.msgErrorClass),a||(s.$errorContainer.hide(),s.previewInitId="preview-"+t.uniqId(),s._initPreviewCache(),s._initPreview(!0),s._initPreviewActions(),s._setFileDropZoneTitle(),s.$parent.hasClass("file-loading")&&(s.$container.insertBefore(s.$parent),s.$parent.remove())),d.attr("disabled")&&s.disable(),s._initZoom(),s.hideThumbnailContent&&t.addCss(s.$preview,"hide-content")},_initTemplateDefaults:function(){var i,a,n,r,o,l,s,d,c,p,u=this;i=t.closeButton("fileinput-remove"),a='<div id="'+t.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+t.MODAL_ID+'Label"></div>',r=(n='<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"')+'><div class="kv-file-content">\n',o=n+' title="{caption}"><div class="kv-file-content">\n',l='<video class="kv-preview-data file-preview-video" controls {style}>\n<source src="{data}" type="{type}">\n'+t.DEFAULT_PREVIEW+"\n</video>\n",s='<audio class="kv-preview-data file-preview-audio" controls {style}>\n<source src="{data}" type="{type}">\n'+t.DEFAULT_PREVIEW+"\n</audio>\n",d='<object class="kv-preview-data file-preview-object file-object {typeCss}" data="{data}" type="{type}" {style}>\n<param name="movie" value="{caption}" />\n'+t.OBJECT_PARAMS+" "+t.DEFAULT_PREVIEW+"\n</object>\n",c='<div class="kv-preview-data file-preview-other-frame" {style}>\n'+t.DEFAULT_PREVIEW+"\n</div>\n",p={width:"100%",height:"100%","min-height":"480px"},u.defaults={layoutTemplates:{main1:'{preview}\n<div class="kv-upload-progress kv-hidden"></div><div class="clearfix"></div>\n<div class="input-group {class}">\n  {caption}\n<div class="input-group-btn">\n      {remove}\n      {cancel}\n      {upload}\n      {browse}\n \t   {capture}\n \t   {fileURL}\n    </div>\n</div>',main2:'{preview}\n<div class="kv-upload-progress kv-hidden"></div>\n<div class="clearfix"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n{capture}\n{fileURL}\n',preview:'<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',close:i,fileIcon:'<i class="glyphicon glyphicon-file"></i>',caption:'<div class="file-caption form-control {class}" tabindex="500">\n  <span class="file-caption-icon"></span>\n  <input class="file-caption-name" onkeydown="return false;" onpaste="return false;">\n</div>',modalMain:a,modal:'<div class="modal-dialog modal-lg{rtl}" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <h5 class="modal-title">{heading}</h5>\n      <span class="kv-zoom-title"></span>\n      <div class="kv-zoom-actions">{toggleheader}{fullscreen}{borderless}{close}</div>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n',progress:'<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {status}\n     </div>\n</div>',size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">\n        <div class="file-caption-info">{caption}</div>\n        <div class="file-size-info">{size}</div>\n    </div>\n    {progress}\n{indicator}\n{actions}\n</div>',indicator:'<div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>',actions:'<div class="file-actions">\n    <div class="file-footer-buttons">\n        {download} {upload} {delete} {zoom} {other}    </div>\n</div>\n{drag}\n<div class="clearfix"></div>',actionDelete:'<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n',actionUpload:'<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',actionDownload:'<button type="button" class="kv-file-download {downloadClass}" title="{downloadTitle}" data-url="{downloadUrl}" data-caption="{caption}">{downloadIcon}</button>',actionZoom:'<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',actionDrag:'<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',btnDefault:'<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',btnLink:'<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',btnBrowse:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',btnCapture:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',btnFileURL:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',zoomCache:'<div class="kv-zoom-cache" style="display:none">{zoomContent}</div>'},previewMarkupTags:{tagBefore1:r,tagBefore2:o,tagAfter:"</div>{footer}\n</div>\n"},previewContentTemplates:{generic:"{content}\n",html:'<div class="kv-preview-data file-preview-html" title="{caption}" {style}>{data}</div>\n',image:'<img src="{data}" class="file-preview-image kv-preview-data" title="{caption}" alt="{caption}" {style}>\n',text:'<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly {style}>{data}</textarea>\n',office:'<iframe class="kv-preview-data file-preview-office" src="https://docs.google.com/gview?url={data}&embedded=true" {style}></iframe>',video:l,audio:s,flash:'<embed class="kv-preview-data file-preview-flash" src="{data}" type="application/x-shockwave-flash" {style}>\n',object:d,pdf:'<embed class="kv-preview-data file-preview-pdf" src="{data}" type="application/pdf" {style}>\n',other:c},allowedPreviewTypes:["image","html","text","video","audio","flash","pdf","object"],previewTemplates:{},previewSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},office:{width:"213px",height:"160px"},video:{width:"213px",height:"160px"},audio:{width:"100%",height:"30px"},flash:{width:"213px",height:"160px"},object:{width:"213px",height:"160px"},pdf:{width:"213px",height:"160px"},other:{width:"213px",height:"160px"}},previewSettingsSmall:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"100%",height:"160px"},text:{width:"100%",height:"160px"},office:{width:"100%",height:"160px"},video:{width:"100%",height:"auto"},audio:{width:"100%",height:"30px"},flash:{width:"100%",height:"auto"},object:{width:"100%",height:"auto"},pdf:{width:"100%",height:"160px"},other:{width:"100%",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:p,text:p,office:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:p,other:{width:"auto",height:"100%","min-height":"480px"}},fileTypeSettings:{image:function(e,i){return t.compare(e,"image.*")&&!t.compare(e,/(tiff?|wmf)$/i)||t.compare(i,/\.(gif|png|jpe?g)$/i)},html:function(e,i){return t.compare(e,"text/html")||t.compare(i,/\.(htm|html)$/i)},office:function(e,i){return t.compare(e,/(word|excel|powerpoint|office|iwork-pages|tiff?)$/i)||t.compare(i,/\.(rtf|docx?|xlsx?|pptx?|pps|potx?|ods|odt|pages|ai|dxf|ttf|tiff?|wmf|e?ps)$/i)},text:function(e,i){return t.compare(e,"text.*")||t.compare(i,/\.(xml|javascript)$/i)||t.compare(i,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(e,i){return t.compare(e,"video.*")&&(t.compare(e,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||t.compare(i,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(e,i){return t.compare(e,"audio.*")&&(t.compare(i,/(ogg|mp3|mp?g|wav)$/i)||t.compare(i,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(e,i){return t.compare(e,"application/x-shockwave-flash",!0)||t.compare(i,/\.(swf)$/i)},pdf:function(e,i){return t.compare(e,"application/pdf",!0)||t.compare(i,/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},fileActionSettings:{showRemove:!0,showUpload:!0,showDownload:!0,showZoom:!0,showDrag:!1,removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-kv btn-default btn-outline-secondary",removeErrorClass:"btn btn-kv btn-danger",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-kv btn-default btn-outline-secondary",uploadTitle:"Upload file",uploadRetryIcon:'<i class="glyphicon glyphicon-repeat"></i>',uploadRetryTitle:"Retry upload",downloadIcon:'<i class="glyphicon glyphicon-download"></i>',downloadClass:"btn btn-kv btn-default btn-outline-secondary",downloadTitle:"Download file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-kv btn-default btn-outline-secondary",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-move"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-plus-sign text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hourglass text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."}},e.each(u.defaults,(function(t,i){"allowedPreviewTypes"!==t?u[t]=e.extend(!0,{},i,u[t]):void 0===u.allowedPreviewTypes&&(u.allowedPreviewTypes=i)})),u._initPreviewTemplates()},_initPreviewTemplates:function(){var i,a=this,n=a.defaults,r=a.previewMarkupTags,o=r.tagAfter;e.each(n.previewContentTemplates,(function(e,n){t.isEmpty(a.previewTemplates[e])&&(i=r.tagBefore2,"generic"!==e&&"image"!==e&&"html"!==e&&"text"!==e||(i=r.tagBefore1),a.previewTemplates[e]=i+n+o)}))},_initPreviewCache:function(){var i=this;i.previewCache={data:{},init:function(){var e=i.initialPreview;e.length>0&&!t.isArray(e)&&(e=e.split(i.initialPreviewDelimiter)),i.previewCache.data={content:e,config:i.initialPreviewConfig,tags:i.initialPreviewThumbTags}},count:function(){return i.previewCache.data&&i.previewCache.data.content?i.previewCache.data.content.length:0},get:function(a,n){var r,o,l,s,d,c,p,u="init_"+a,f=i.previewCache.data,h=f.config[a],m=f.content[a],g=i.previewInitId+"-"+u,v=t.ifSet("previewAsData",h,i.initialPreviewAsData),w=function(e,a,n,r,o,l,s,d,c){return d=" file-preview-initial "+t.SORT_CSS+(d?" "+d:""),i._generatePreviewTemplate(e,a,n,r,o,!1,null,d,l,s,c)};return m?(n=void 0===n||n,l=t.ifSet("type",h,i.initialPreviewFileType||"generic"),d=t.ifSet("filename",h,t.ifSet("caption",h)),c=t.ifSet("filetype",h,l),s=i.previewCache.footer(a,n,h&&h.size||null),p=t.ifSet("frameClass",h),r=v?w(l,m,d,c,g,s,u,p):w("generic",m,d,c,g,s,u,p,l).setTokens({content:f.content[a]}),f.tags.length&&f.tags[a]&&(r=t.replaceTags(r,f.tags[a])),t.isEmpty(h)||t.isEmpty(h.frameAttr)||((o=e(F.createElement("div")).html(r)).find(".file-preview-initial").attr(h.frameAttr),r=o.html(),o.remove()),r):""},add:function(e,a,n,r){var o,l=i.previewCache.data;return t.isArray(e)||(e=e.split(i.initialPreviewDelimiter)),r?(o=l.content.push(e)-1,l.config[o]=a,l.tags[o]=n):(o=e.length-1,l.content=e,l.config=a,l.tags=n),i.previewCache.data=l,o},set:function(e,a,n,r){var o,l=i.previewCache.data;if(e&&e.length&&(t.isArray(e)||(e=e.split(i.initialPreviewDelimiter)),e.filter((function(e){return null!==e})).length)){if(void 0===l.content&&(l.content=[]),void 0===l.config&&(l.config=[]),void 0===l.tags&&(l.tags=[]),r){for(o=0;o<e.length;o++)e[o]&&l.content.push(e[o]);for(o=0;o<a.length;o++)a[o]&&l.config.push(a[o]);for(o=0;o<n.length;o++)n[o]&&l.tags.push(n[o])}else l.content=e,l.config=a,l.tags=n;i.previewCache.data=l}},unset:function(e){var t=i.previewCache.count();if(t){if(1===t)return i.previewCache.data.content=[],i.previewCache.data.config=[],i.previewCache.data.tags=[],i.initialPreview=[],i.initialPreviewConfig=[],void(i.initialPreviewThumbTags=[]);i.previewCache.data.content.splice(e,1),i.previewCache.data.config.splice(e,1),i.previewCache.data.tags.splice(e,1)}},out:function(){var e,t="",a=i.previewCache.count();if(0===a)return{content:"",caption:""};for(e=0;e<a;e++)t+=i.previewCache.get(e);return{content:t,caption:i._getMsgSelected(a)}},footer:function(e,a,n){var r=i.previewCache.data||{};if(t.isEmpty(r.content))return"";(t.isEmpty(r.config)||t.isEmpty(r.config[e]))&&(r.config[e]={}),a=void 0===a||a;var o,l=r.config[e],s=t.ifSet("caption",l),d=t.ifSet("width",l,"auto"),c=t.ifSet("url",l,!1),p=t.ifSet("key",l,null),u=i.fileActionSettings,f=i.initialPreviewShowDelete||!1,h=l.downloadUrl||i.initialPreviewDownloadUrl||"",m=l.filename||l.caption||"",g=!!h,v=t.ifSet("showDelete",l,t.ifSet("showDelete",u,f)),w=t.ifSet("showDownload",l,t.ifSet("showDownload",u,g)),b=t.ifSet("showZoom",l,t.ifSet("showZoom",u,!0)),_=t.ifSet("showDrag",l,t.ifSet("showDrag",u,!0)),y=!1===c&&a;return w=w&&!1!==l.downloadUrl&&!!h,o=i._renderFileActions(!1,w,v,b,_,y,c,p,!0,h,m),i._getLayoutTemplate("footer").setTokens({progress:i._renderThumbProgress(),actions:o,caption:s,size:i._getSize(n),width:d,indicator:""})}},i.previewCache.init()},_handler:function(e,t,i){var a=this.namespace,n=t.split(" ").join(a+" ")+a;e&&e.length&&e.off(n).on(n,i)},_log:function(e){var t=this.$element.attr("id");t&&(e='"'+t+'": '+e),void 0!==window.console.log?window.console.log(e):window.alert(e)},_validate:function(){var e="file"===this.$element.attr("type");return e||this._log('The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.'),e},_errorsExist:function(){var t;return!!this.$errorContainer.find("li").length||((t=e(F.createElement("div")).html(this.$errorContainer.html())).find(".kv-error-close").remove(),t.find("ul").remove(),!!e.trim(t.text()).length)},_errorHandler:function(e,t){var i=this,a=e.target.error,n=function(e){i._showError(e.replace("{name}",t))};a.code===a.NOT_FOUND_ERR?n(i.msgFileNotFound):a.code===a.SECURITY_ERR?n(i.msgFileSecured):a.code===a.NOT_READABLE_ERR?n(i.msgFileNotReadable):a.code===a.ABORT_ERR?n(i.msgFilePreviewAborted):n(i.msgFilePreviewError)},_addError:function(e){var t=this,i=t.$errorContainer;e&&i.length&&(i.html(t.errorCloseButton+e),t._handler(i.find(".kv-error-close"),"click",(function(){P((function(){t.showPreview&&!t.getFrames().length&&t.clear(),i.fadeOut("slow")}),10)})))},_setValidationError:function(e){e=(e?e+" ":"")+"has-error",this.$container.removeClass(e).addClass("has-error"),t.addCss(this.$captionContainer,"is-invalid")},_resetErrors:function(e){var t=this,i=t.$errorContainer;t.isError=!1,t.$container.removeClass("has-error"),t.$captionContainer.removeClass("is-invalid"),i.html(""),e?i.fadeOut("slow"):i.hide()},_showFolderError:function(e){var t,i=this,a=i.$errorContainer;e&&(t=i.msgFoldersNotAllowed.replace("{n}",e),i._addError(t),i._setValidationError(),a.fadeIn(800),i._raise("filefoldererror",[e,t]))},_showUploadError:function(e,t,i){var a=this,n=a.$errorContainer,r=i||"fileuploaderror",o=t&&t.id?'<li data-file-id="'+t.id+'">'+e+"</li>":"<li>"+e+"</li>";return 0===n.find("ul").length?a._addError("<ul>"+o+"</ul>"):n.find("ul").append(o),n.fadeIn(800),a._raise(r,[t,e]),a._setValidationError("file-input-new"),!0},_showError:function(e,t,i){var a=this,n=a.$errorContainer,r=i||"fileerror";return(t=t||{}).reader=a.reader,a._addError(e),n.fadeIn(800),a._raise(r,[t,e]),a.isAjaxUpload||a._clearFileInput(),a._setValidationError("file-input-new"),a.$btnUpload.attr("disabled",!0),!0},_noFilesError:function(e){var t=this,i=t.minFileCount>1?t.filePlural:t.fileSingle,a=t.msgFilesTooLess.replace("{n}",t.minFileCount).replace("{files}",i),n=t.$errorContainer;t._addError(a),t.isError=!0,t._updateFileDetails(0),n.fadeIn(800),t._raise("fileerror",[e,a]),t._clearFileInput(),t._setValidationError()},_parseError:function(t,i,a,n){var r,o=this,l=e.trim(a+""),s=void 0!==i.responseJSON&&void 0!==i.responseJSON.error?i.responseJSON.error:i.responseText;return o.cancelling&&o.msgUploadAborted&&(l=o.msgUploadAborted),o.showAjaxErrorDetails&&s&&(r=(s=e.trim(s.replace(/\n\s*\n/g,"\n"))).length?"<pre>"+s+"</pre>":"",l+=l?r:s),l||(l=o.msgAjaxError.replace("{operation}",t)),o.cancelling=!1,n?"<b>"+n+": </b>"+l:l},_parseFileType:function(e,i){var a,n,r,o=this.allowedPreviewTypes||[];if("application/text-plain"===e)return"text";for(r=0;r<o.length;r++)if(n=o[r],a=(0,this.fileTypeSettings[n])(e,i)?n:"",!t.isEmpty(a))return a;return"other"},_getPreviewIcon:function(t){var i,a=this,n=null;return t&&t.indexOf(".")>-1&&(i=t.split(".").pop(),a.previewFileIconSettings&&(n=a.previewFileIconSettings[i]||a.previewFileIconSettings[i.toLowerCase()]||null),a.previewFileExtSettings&&e.each(a.previewFileExtSettings,(function(e,t){a.previewFileIconSettings[e]&&t(i)&&(n=a.previewFileIconSettings[e])}))),n},_parseFilePreviewIcon:function(e,t){var i=this,a=i._getPreviewIcon(t)||i.previewFileIcon,n=e;return n.indexOf("{previewFileIcon}")>-1&&(n=n.setTokens({previewFileIconClass:i.previewFileIconClass,previewFileIcon:a})),n},_raise:function(t,i){var a=this,n=e.Event(t);if(void 0!==i?a.$element.trigger(n,i):a.$element.trigger(n),n.isDefaultPrevented()||!1===n.result)return!1;switch(t){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:a.ajaxAborted||(a.ajaxAborted=n.result)}return!0},_listenFullScreen:function(e){var t,i,a=this,n=a.$modal;n&&n.length&&(t=n&&n.find(".btn-fullscreen"),i=n&&n.find(".btn-borderless"),t.length&&i.length&&(t.removeClass("active").attr("aria-pressed","false"),i.removeClass("active").attr("aria-pressed","false"),e?t.addClass("active").attr("aria-pressed","true"):i.addClass("active").attr("aria-pressed","true"),n.hasClass("file-zoom-fullscreen")||e?a._maximizeZoomDialog():i.removeClass("active").attr("aria-pressed","false")))},_listen:function(){var i=this,a=i.$element,n=i.$form,r=i.$container;i._handler(a,"change",e.proxy(i._change,i)),i.showBrowse&&i._handler(i.$btnFile,"click",e.proxy(i._browse,i)),i.showCapture&&i._handler(i.$container.find(".fileinput-capture"),"click",e.proxy(i._capture,i)),i.showFileURL&&i._handler(i.$container.find(".fileinput-fileURL"),"click",e.proxy(i._fileURL,i)),i._handler(r.find(".fileinput-remove:not([disabled])"),"click",e.proxy(i.clear,i)),i._handler(r.find(".fileinput-cancel"),"click",e.proxy(i.cancel,i)),i._initDragDrop(),i._handler(n,"reset",e.proxy(i.clear,i)),i.isAjaxUpload||i._handler(n,"submit",e.proxy(i._submitForm,i)),i._handler(i.$container.find(".fileinput-upload"),"click",e.proxy(i._uploadClick,i)),i._handler(e(window),"resize",(function(){i._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)})),i._handler(e(F),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(function(){i._listenFullScreen(t.checkFullScreen())})),i._autoFitContent(),i._initClickable()},_autoFitContent:function(){var t,i=window.innerWidth||F.documentElement.clientWidth||F.body.clientWidth,a=this,n=i<400?a.previewSettingsSmall||a.defaults.previewSettingsSmall:a.previewSettings||a.defaults.previewSettings;e.each(n,(function(e,i){t=".file-preview-frame .file-preview-"+e,a.$preview.find(t+".kv-preview-data,"+t+" .kv-preview-data").css(i)}))},_initClickable:function(){var i,a=this;a.isClickable&&(i=a.isAjaxUpload?a.$dropZone:a.$preview.find(".file-default-preview"),t.addCss(i,"clickable"),i.attr("tabindex",-1),a._handler(i,"click",(function(t){var n=e(t.target);i.find(".kv-fileinput-error:visible").length||n.parents(".file-preview-thumbnails").length&&!n.parents(".file-default-preview").length||(a.$element.trigger("click"),i.blur())})))},_initDragDrop:function(){var t=this,i=t.$dropZone;t.isAjaxUpload&&t.dropZoneEnabled&&t.showPreview&&(t._handler(i,"dragenter dragover",e.proxy(t._zoneDragEnter,t)),t._handler(i,"dragleave",e.proxy(t._zoneDragLeave,t)),t._handler(i,"drop",e.proxy(t._zoneDrop,t)),t._handler(e(F),"dragenter dragover drop",t._zoneDragDropInit))},_zoneDragDropInit:function(e){e.stopPropagation(),e.preventDefault()},_zoneDragEnter:function(i){var a=this,n=e.inArray("Files",i.originalEvent.dataTransfer.types)>-1;if(a._zoneDragDropInit(i),a.isDisabled||!n)return i.originalEvent.dataTransfer.effectAllowed="none",void(i.originalEvent.dataTransfer.dropEffect="none");t.addCss(a.$dropZone,"file-highlighted")},_zoneDragLeave:function(e){var t=this;t._zoneDragDropInit(e),t.isDisabled||t.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(e){var i=this;e.preventDefault(),i.isDisabled||t.isEmpty(e.originalEvent.dataTransfer.files)||(i._change(e,"dragdrop"),i.$dropZone.removeClass("file-highlighted"))},_uploadClick:function(e){var i,a=this,n=a.$container.find(".fileinput-upload"),r=!n.hasClass("disabled")&&t.isEmpty(n.attr("disabled"));e&&e.isDefaultPrevented()||(a.isAjaxUpload?(e.preventDefault(),r&&a.upload()):r&&"submit"!==n.attr("type")&&((i=n.closest("form")).length&&i.trigger("submit"),e.preventDefault()))},_submitForm:function(){return this._isFileSelectionValid()&&!this._abort({})},_clearPreview:function(){var i=this,a=i.$preview;(i.showUploadedThumbs?i.getFrames(":not(.file-preview-success)"):i.getFrames()).each((function(){var i=e(this);i.remove(),t.cleanZoomCache(a.find("#zoom-"+i.attr("id")))})),i.getFrames().length&&i.showPreview||i._resetUpload(),i._validateDefaultPreview()},_initSortable:function(){var i,a=this,n=a.$preview,r="."+t.SORT_CSS;window.KvSortable&&0!==n.find(r).length&&(i={handle:".drag-handle-init",dataIdAttr:"data-preview-id",scroll:!1,draggable:r,onSort:function(i){var n=i.oldIndex,r=i.newIndex;a.initialPreview=t.moveArray(a.initialPreview,n,r),a.initialPreviewConfig=t.moveArray(a.initialPreviewConfig,n,r),a.previewCache.init();for(var o=0;o<a.initialPreviewConfig.length;o++)null!==a.initialPreviewConfig[o]&&e(i.item).closest(t.FRAMES).attr("data-fileindex","init_"+o).attr("data-fileindex","init_"+o);a._raise("filesorted",{previewId:e(i.item).attr("id"),oldIndex:n,newIndex:r,stack:a.initialPreviewConfig})}},n.data("kvsortable")&&n.kvsortable("destroy"),e.extend(!0,i,a.fileActionSettings.dragSettings),n.kvsortable(i))},_setPreviewContent:function(e){this.$preview.html(e),this._autoFitContent()},_initPreview:function(e){var i,a=this,n=a.initialCaption||"";if(!a.previewCache.count())return a._clearPreview(),void(e?a._setCaption(n):a._initCaption());i=a.previewCache.out(),n=e&&a.initialCaption?a.initialCaption:i.caption,a._setPreviewContent(i.content),a._setInitThumbAttr(),a._setCaption(n),a._initSortable(),t.isEmpty(i.content)||a.$container.removeClass("file-input-new")},_getZoomButton:function(e){var t=this,i=t.previewZoomButtonIcons[e],a=t.previewZoomButtonClasses[e],n=' title="'+(t.previewZoomButtonTitles[e]||"")+'" '+("close"===e?' data-dismiss="modal" aria-hidden="true"':"");return"fullscreen"!==e&&"borderless"!==e&&"toggleheader"!==e||(n+=' data-toggle="button" aria-pressed="false" autocomplete="off"'),'<button type="button" class="'+a+" btn-"+e+'"'+n+">"+i+"</button>"},_getModalContent:function(){var e=this;return e._getLayoutTemplate("modal").setTokens({rtl:e.rtl?" kv-rtl":"",zoomFrameClass:e.frameClass,heading:e.msgZoomModalHeading,prev:e._getZoomButton("prev"),next:e._getZoomButton("next"),toggleheader:e._getZoomButton("toggleheader"),fullscreen:e._getZoomButton("fullscreen"),borderless:e._getZoomButton("borderless"),close:e._getZoomButton("close")})},_listenModalEvent:function(e){var i=this,a=i.$modal;a.on(e+".bs.modal",(function(n){var r=a.find(".btn-fullscreen"),o=a.find(".btn-borderless");i._raise("filezoom"+e,function(e){return{sourceEvent:e,previewId:a.data("previewId"),modal:a}}(n)),"shown"===e&&(o.removeClass("active").attr("aria-pressed","false"),r.removeClass("active").attr("aria-pressed","false"),a.hasClass("file-zoom-fullscreen")&&(i._maximizeZoomDialog(),t.checkFullScreen()?r.addClass("active").attr("aria-pressed","true"):o.addClass("active").attr("aria-pressed","true")))}))},_initZoom:function(){var i,a=this,n=a._getLayoutTemplate("modalMain"),r="#"+t.MODAL_ID;a.showPreview&&(a.$modal=e(r),a.$modal&&a.$modal.length||(i=e(F.createElement("div")).html(n).insertAfter(a.$container),a.$modal=e(r).insertBefore(i),i.remove()),t.initModal(a.$modal),a.$modal.html(a._getModalContent()),e.each(t.MODAL_EVENTS,(function(e,t){a._listenModalEvent(t)})))},_initZoomButtons:function(){var t,i,a=this,n=a.$modal.data("previewId")||"",r=a.getFrames().toArray(),o=r.length,l=a.$modal.find(".btn-prev"),s=a.$modal.find(".btn-next");if(r.length<2)return l.hide(),void s.hide();l.show(),s.show(),o&&(t=e(r[0]),i=e(r[o-1]),l.removeAttr("disabled"),s.removeAttr("disabled"),t.length&&t.attr("id")===n&&l.attr("disabled",!0),i.length&&i.attr("id")===n&&s.attr("disabled",!0))},_maximizeZoomDialog:function(){var t=this.$modal,i=t.find(".modal-header:visible"),a=t.find(".modal-footer:visible"),n=t.find(".modal-body"),r=e(window).height();t.addClass("file-zoom-fullscreen"),i&&i.length&&(r-=i.outerHeight(!0)),a&&a.length&&(r-=a.outerHeight(!0)),n&&n.length&&(r-=n.outerHeight(!0)-n.height()),t.find(".kv-zoom-body").height(r)},_resizeZoomDialog:function(e){var i=this,a=i.$modal,n=a.find(".btn-fullscreen"),r=a.find(".btn-borderless");if(a.hasClass("file-zoom-fullscreen"))t.toggleFullScreen(!1),e?n.hasClass("active")||(a.removeClass("file-zoom-fullscreen"),i._resizeZoomDialog(!0),r.hasClass("active")&&r.removeClass("active").attr("aria-pressed","false")):n.hasClass("active")?n.removeClass("active").attr("aria-pressed","false"):(a.removeClass("file-zoom-fullscreen"),i.$modal.find(".kv-zoom-body").css("height",i.zoomModalHeight));else{if(!e)return void i._maximizeZoomDialog();t.toggleFullScreen(!0)}a.focus()},_setZoomContent:function(i,a){var n,r,o,l,s,d,c,p,u=this,f=i.attr("id"),h=u.$modal,m=h.find(".btn-prev"),g=h.find(".btn-next"),v=h.find(".btn-fullscreen"),w=h.find(".btn-borderless"),b=h.find(".btn-toggleheader"),_=u.$preview.find("#zoom-"+f);r=_.attr("data-template")||"generic",o=(n=_.find(".kv-file-content")).length?n.html():"",l=(i.data("caption")||"")+" "+(i.data("size")||""),h.find(".kv-zoom-title").attr("title",e("<div/>").html(l).text()).html(l),s=h.find(".kv-zoom-body"),h.removeClass("kv-single-content"),a?(p=s.addClass("file-thumb-loading").clone().insertAfter(s),s.html(o).hide(),p.fadeOut("fast",(function(){s.fadeIn("fast",(function(){s.removeClass("file-thumb-loading")})),p.remove()}))):s.html(o),(c=u.previewZoomSettings[r])&&(d=s.find(".kv-preview-data"),t.addCss(d,"file-zoom-detail"),e.each(c,(function(e,t){d.css(e,t),(d.attr("width")&&"width"===e||d.attr("height")&&"height"===e)&&d.removeAttr(e)}))),h.data("previewId",f);var y=s.find("img");y.length&&t.adjustOrientedImage(y,!0),u._handler(m,"click",(function(){u._zoomSlideShow("prev",f)})),u._handler(g,"click",(function(){u._zoomSlideShow("next",f)})),u._handler(v,"click",(function(){u._resizeZoomDialog(!0)})),u._handler(w,"click",(function(){u._resizeZoomDialog(!1)})),u._handler(b,"click",(function(){var e,t=h.find(".modal-header"),i=h.find(".modal-body .floating-buttons"),a=t.find(".kv-zoom-actions"),n=function(e){var i=u.$modal.find(".kv-zoom-body"),a=u.zoomModalHeight;h.hasClass("file-zoom-fullscreen")&&(a=i.outerHeight(!0),e||(a-=t.outerHeight(!0))),i.css("height",e?a+e:a)};t.is(":visible")?(e=t.outerHeight(!0),t.slideUp("slow",(function(){a.find(".btn").appendTo(i),n(e)}))):(i.find(".btn").appendTo(a),t.slideDown("slow",(function(){n()}))),h.focus()})),u._handler(h,"keydown",(function(e){var t=e.which||e.keyCode;37!==t||m.attr("disabled")||u._zoomSlideShow("prev",f),39!==t||g.attr("disabled")||u._zoomSlideShow("next",f)}))},_zoomPreview:function(e){var i,a=this,n=a.$modal;if(!e.length)throw"Cannot zoom to detailed preview!";t.initModal(n),n.html(a._getModalContent()),i=e.closest(t.FRAMES),a._setZoomContent(i),n.modal("show"),a._initZoomButtons()},_zoomSlideShow:function(t,i){var a,n,r,o=this,l=o.$modal.find(".kv-zoom-actions .btn-"+t),s=o.getFrames().toArray(),d=s.length;if(!l.attr("disabled")){for(n=0;n<d;n++)if(e(s[n]).attr("id")===i){r="prev"===t?n-1:n+1;break}r<0||r>=d||!s[r]||((a=e(s[r])).length&&o._setZoomContent(a,!0),o._initZoomButtons(),o._raise("filezoom"+t,{previewId:i,modal:o.$modal}))}},_initZoomButton:function(){var t=this;t.$preview.find(".kv-file-zoom").each((function(){var i=e(this);t._handler(i,"click",(function(){t._zoomPreview(i)}))}))},_clearObjects:function(t){t.find("video audio").each((function(){this.pause(),e(this).remove()})),t.find("img object div").each((function(){e(this).remove()}))},_clearFileInput:function(){var i,a,n,r=this,o=r.$element;r.fileInputCleared=!0,t.isEmpty(o.val())||(r.isIE9||r.isIE10?(i=o.closest("form"),a=e(F.createElement("form")),n=e(F.createElement("div")),o.before(n),i.length?i.after(a):n.after(a),a.append(o).trigger("reset"),n.before(o).remove(),a.remove()):o.val(""))},_resetUpload:function(){var e=this;e.uploadCache={content:[],config:[],tags:[],append:!0},e.uploadCount=0,e.uploadStatus={},e.uploadLog=[],e.uploadAsyncCount=0,e.loadedImages=[],e.totalImagesCount=0,e.$btnUpload.removeAttr("disabled"),e._setProgress(0),e.$progress.hide(),e._resetErrors(!1),e.ajaxAborted=!1,e.ajaxRequests=[],e._resetCanvas(),e.cacheInitialPreview={},e.overwriteInitial&&(e.initialPreview=[],e.initialPreviewConfig=[],e.initialPreviewThumbTags=[],e.previewCache.data={content:[],config:[],tags:[]})},_resetCanvas:function(){var e=this;e.canvas&&e.imageCanvasContext&&e.imageCanvasContext.clearRect(0,0,e.canvas.width,e.canvas.height)},_hasInitialPreview:function(){return!this.overwriteInitial&&this.previewCache.count()},_resetPreview:function(){var e,t,i=this;i.previewCache.count()?(e=i.previewCache.out(),i._setPreviewContent(e.content),i._setInitThumbAttr(),t=i.initialCaption?i.initialCaption:e.caption,i._setCaption(t)):(i._clearPreview(),i._initCaption()),i.showPreview&&(i._initZoom(),i._initSortable())},_clearDefaultPreview:function(){this.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){var e=this;e.showPreview&&!t.isEmpty(e.defaultPreviewContent)&&(e._setPreviewContent('<div class="file-default-preview">'+e.defaultPreviewContent+"</div>"),e.$container.removeClass("file-input-new"),e._initClickable())},_resetPreviewThumbs:function(e){var t,i=this;if(e)return i._clearPreview(),void i.clearStack();i._hasInitialPreview()?(t=i.previewCache.out(),i._setPreviewContent(t.content),i._setInitThumbAttr(),i._setCaption(t.caption),i._initPreviewActions()):i._clearPreview()},_getLayoutTemplate:function(e){var i=this,a=i.layoutTemplates[e];return t.isEmpty(i.customLayoutTags)?a:t.replaceTags(a,i.customLayoutTags)},_getPreviewTemplate:function(e){var i=this,a=i.previewTemplates[e];return t.isEmpty(i.customPreviewTags)?a:t.replaceTags(a,i.customPreviewTags)},_getOutData:function(e,t,i){var a=this;return e=e||{},t=t||{},i=i||a.filestack.slice(0)||{},{form:a.formdata,files:i,filenames:a.filenames,filescount:a.getFilesCount(),extra:a._getExtraData(),response:t,reader:a.reader,jqXHR:e}},_getMsgSelected:function(e){var t=this,i=1===e?t.fileSingle:t.filePlural;return e>0?t.msgSelected.replace("{n}",e).replace("{files}",i):t.msgNoFilesSelected},_getFrame:function(t){var i=e("#"+t);return i.length?i:(this._log('Invalid thumb frame with id: "'+t+'".'),null)},_getThumbs:function(e){return e=e||"",this.getFrames(":not(.file-preview-initial)"+e)},_getExtraData:function(e,t){var i=this,a=i.uploadExtraData;return"function"==typeof i.uploadExtraData&&(a=i.uploadExtraData(e,t)),a},_initXhr:function(e,t,i){var a=this;return e.upload&&e.upload.addEventListener("progress",(function(e){var n=0,r=e.total,o=e.loaded||e.position;e.lengthComputable&&(n=Math.floor(o/r*100)),t?a._setAsyncUploadStatus(t,n,i):a._setProgress(n)}),!1),e},_mergeAjaxCallback:function(e,t,i){var a,n=this,r=n.ajaxSettings,o=n.mergeAjaxCallbacks;"delete"===i&&(r=n.ajaxDeleteSettings,o=n.mergeAjaxDeleteCallbacks),a=r[e],r[e]=o&&"function"==typeof a?"before"===o?function(){a.apply(this,arguments),t.apply(this,arguments)}:function(){t.apply(this,arguments),a.apply(this,arguments)}:t,"delete"===i?n.ajaxDeleteSettings=r:n.ajaxSettings=r},_ajaxSubmit:function(t,i,a,n,r,o){var l,s=this;s._raise("filepreajax",[r,o])&&(s._uploadExtra(r,o),s._mergeAjaxCallback("beforeSend",t),s._mergeAjaxCallback("success",i),s._mergeAjaxCallback("complete",a),s._mergeAjaxCallback("error",n),l=e.extend(!0,{},{xhr:function(){var t=e.ajaxSettings.xhr();return s._initXhr(t,r,s.getFileStack().length)},url:o&&s.uploadUrlThumb?s.uploadUrlThumb:s.uploadUrl,type:"POST",dataType:"json",data:s.formdata,cache:!1,processData:!1,contentType:!1},s.ajaxSettings),s.ajaxRequests.push(e.ajax(l)))},_mergeArray:function(e,i){var a=t.cleanArray(this[e]),n=t.cleanArray(i);this[e]=a.concat(n)},_initUploadSuccess:function(i,a,n){var r,o,l,s,d,c,p,u,f,h=this;h.showPreview&&"object"==typeof i&&!e.isEmptyObject(i)&&void 0!==i.initialPreview&&i.initialPreview.length>0&&(h.hasInitData=!0,c=i.initialPreview||[],p=i.initialPreviewConfig||[],u=i.initialPreviewThumbTags||[],r=void 0===i.append||i.append,c.length>0&&!t.isArray(c)&&(c=c.split(h.initialPreviewDelimiter)),h._mergeArray("initialPreview",c),h._mergeArray("initialPreviewConfig",p),h._mergeArray("initialPreviewThumbTags",u),void 0!==a?n?(f=a.attr("data-fileindex"),h.uploadCache.content[f]=c[0],h.uploadCache.config[f]=p[0]||[],h.uploadCache.tags[f]=u[0]||[],h.uploadCache.append=r):(l=h.previewCache.add(c,p[0],u[0],r),o=h.previewCache.get(l,!1),(d=(s=e(F.createElement("div")).html(o).hide().insertAfter(a)).find(".kv-zoom-cache"))&&d.length&&d.insertAfter(a),a.fadeOut("slow",(function(){var e=s.find(".file-preview-frame");e&&e.length&&e.insertBefore(a).fadeIn("slow").css("display:inline-block"),h._initPreviewActions(),h._clearFileInput(),t.cleanZoomCache(h.$preview.find("#zoom-"+a.attr("id"))),a.remove(),s.remove(),h._initSortable()}))):(h.previewCache.set(c,p,u,r),h._initPreview(),h._initPreviewActions()))},_initSuccessThumbs:function(){var i=this;i.showPreview&&i._getThumbs(t.FRAMES+".file-preview-success").each((function(){var a=e(this),n=i.$preview,r=a.find(".kv-file-remove");r.removeAttr("disabled"),i._handler(r,"click",(function(){var e=a.attr("id"),r=i._raise("filesuccessremove",[e,a.attr("data-fileindex")]);t.cleanMemory(a),!1!==r&&a.fadeOut("slow",(function(){t.cleanZoomCache(n.find("#zoom-"+e)),a.remove(),i.getFrames().length||i.reset()}))}))}))},_checkAsyncComplete:function(){var t,i,a=this;for(i=0;i<a.filestack.length;i++)if(a.filestack[i]&&(t=a.previewInitId+"-"+i,-1===e.inArray(t,a.uploadLog)))return!1;return a.uploadAsyncCount===a.uploadLog.length},_uploadExtra:function(t,i){var a=this,n=a._getExtraData(t,i);0!==n.length&&e.each(n,(function(e,t){a.formdata.append(e,t)}))},_uploadSingle:function(i,a){var n,r,o,l,s,d,c,p,u,f,h,m=this,g=m.getFileStack().length,v=new FormData,w=m.previewInitId+"-"+i,b=m.filestack.length>0||!e.isEmptyObject(m.uploadExtraData),_=e("#"+w).find(".file-thumb-progress"),y={id:w,index:i};m.formdata=v,m.showPreview&&(r=e("#"+w+":not(.file-preview-initial)"),l=r.find(".kv-file-upload"),s=r.find(".kv-file-remove"),_.show()),0===g||!b||l&&l.hasClass("disabled")||m._abort(y)||(h=function(e,t){d||m.updateStack(e,void 0),m.uploadLog.push(t),m._checkAsyncComplete()&&(m.fileBatchCompleted=!0)},o=function(){var e,i,a,n=m.uploadCache,r=0,o=m.cacheInitialPreview;m.fileBatchCompleted&&(o&&o.content&&(r=o.content.length),P((function(){var l=0===m.getFileStack(!0).length;if(m.showPreview){if(m.previewCache.set(n.content,n.config,n.tags,n.append),r){for(i=0;i<n.content.length;i++)a=i+r,o.content[a]=n.content[i],o.config.length&&(o.config[a]=n.config[i]),o.tags.length&&(o.tags[a]=n.tags[i]);m.initialPreview=t.cleanArray(o.content),m.initialPreviewConfig=t.cleanArray(o.config),m.initialPreviewThumbTags=t.cleanArray(o.tags)}else m.initialPreview=n.content,m.initialPreviewConfig=n.config,m.initialPreviewThumbTags=n.tags;m.cacheInitialPreview={},m.hasInitData&&(m._initPreview(),m._initPreviewActions())}m.unlock(l),l&&m._clearFileInput(),e=m.$preview.find(".file-preview-initial"),m.uploadAsync&&e.length&&(t.addCss(e,t.SORT_CSS),m._initSortable()),m._raise("filebatchuploadcomplete",[m.filestack,m._getExtraData()]),m.uploadCount=0,m.uploadStatus={},m.uploadLog=[],m._setProgress(101),m.ajaxAborted=!1}),100))},c=function(o){n=m._getOutData(o),m.fileBatchCompleted=!1,a||(m.ajaxAborted=!1),m.showPreview&&(r.hasClass("file-preview-success")||(m._setThumbStatus(r,"Loading"),t.addCss(r,"file-uploading")),l.attr("disabled",!0),s.attr("disabled",!0)),a||m.lock(),m._raise("filepreupload",[n,w,i]),e.extend(!0,y,n),m._abort(y)&&(o.abort(),a||(m._setThumbStatus(r,"New"),r.removeClass("file-uploading"),l.removeAttr("disabled"),s.removeAttr("disabled"),m.unlock()),m._setProgressCancelled())},p=function(o,s,c){var p=m.showPreview&&r.attr("id")?r.attr("id"):w;n=m._getOutData(c,o),e.extend(!0,y,n),P((function(){t.isEmpty(o)||t.isEmpty(o.error)?(m.showPreview&&(m._setThumbStatus(r,"Success"),l.hide(),m._initUploadSuccess(o,r,a),m._setProgress(101,_)),m._raise("fileuploaded",[n,p,i]),a?h(i,p):m.updateStack(i,void 0)):(d=!0,m._showUploadError(o.error,y),m._setPreviewError(r,i,m.filestack[i],m.retryErrorUploads),m.retryErrorUploads||l.hide(),a&&h(i,p),m._setProgress(101,e("#"+p).find(".file-thumb-progress"),m.msgUploadError))}),100)},u=function(){P((function(){m.showPreview&&(l.removeAttr("disabled"),s.removeAttr("disabled"),r.removeClass("file-uploading")),a?o():(m.unlock(!1),m._clearFileInput()),m._initSuccessThumbs()}),100)},f=function(t,n,o){var s=m.ajaxOperations.uploadThumb,c=m._parseError(s,t,o,a&&m.filestack[i].name?m.filestack[i].name:null);d=!0,P((function(){a&&h(i,w),m.uploadStatus[w]=100,m._setPreviewError(r,i,m.filestack[i],m.retryErrorUploads),m.retryErrorUploads||l.hide(),e.extend(!0,y,m._getOutData(t)),m._setProgress(101,_,m.msgAjaxProgressError.replace("{operation}",s)),m._setProgress(101,e("#"+w).find(".file-thumb-progress"),m.msgUploadError),m._showUploadError(c,y)}),100)},v.append(m.uploadFileAttr,m.filestack[i],m.filenames[i]),v.append("file_id",i),m._ajaxSubmit(c,p,u,f,w,i))},_uploadBatch:function(){var i,a,n,r,o,l=this,s=l.filestack,d=s.length,c=l.filestack.length>0||!e.isEmptyObject(l.uploadExtraData);l.formdata=new FormData,0!==d&&c&&!l._abort({})&&(o=function(){e.each(s,(function(e){l.updateStack(e,void 0)})),l._clearFileInput()},i=function(i){l.lock();var a=l._getOutData(i);l.ajaxAborted=!1,l.showPreview&&l._getThumbs().each((function(){var i=e(this),a=i.find(".kv-file-upload"),n=i.find(".kv-file-remove");i.hasClass("file-preview-success")||(l._setThumbStatus(i,"Loading"),t.addCss(i,"file-uploading")),a.attr("disabled",!0),n.attr("disabled",!0)})),l._raise("filebatchpreupload",[a]),l._abort(a)&&(i.abort(),l._getThumbs().each((function(){var t=e(this),i=t.find(".kv-file-upload"),a=t.find(".kv-file-remove");t.hasClass("file-preview-loading")&&(l._setThumbStatus(t,"New"),t.removeClass("file-uploading")),i.removeAttr("disabled"),a.removeAttr("disabled")})),l._setProgressCancelled())},a=function(i,a,n){var r=l._getOutData(n,i),s=0,d=l._getThumbs(":not(.file-preview-success)"),c=t.isEmpty(i)||t.isEmpty(i.errorkeys)?[]:i.errorkeys;t.isEmpty(i)||t.isEmpty(i.error)?(l._raise("filebatchuploadsuccess",[r]),o(),l.showPreview?(d.each((function(){var t=e(this);l._setThumbStatus(t,"Success"),t.removeClass("file-uploading"),t.find(".kv-file-upload").hide().removeAttr("disabled")})),l._initUploadSuccess(i)):l.reset(),l._setProgress(101)):(l.showPreview&&(d.each((function(){var t=e(this),i=t.attr("data-fileindex");t.removeClass("file-uploading"),t.find(".kv-file-upload").removeAttr("disabled"),t.find(".kv-file-remove").removeAttr("disabled"),0===c.length||-1!==e.inArray(s,c)?(l._setPreviewError(t,i,l.filestack[i],l.retryErrorUploads),l.retryErrorUploads||(t.find(".kv-file-upload").hide(),l.updateStack(i,void 0))):(t.find(".kv-file-upload").hide(),l._setThumbStatus(t,"Success"),l.updateStack(i,void 0)),t.hasClass("file-preview-error")&&!l.retryErrorUploads||s++})),l._initUploadSuccess(i)),l._showUploadError(i.error,r,"filebatchuploaderror"),l._setProgress(101,l.$progress,l.msgUploadError))},r=function(){l.unlock(),l._initSuccessThumbs(),l._clearFileInput(),l._raise("filebatchuploadcomplete",[l.filestack,l._getExtraData()])},n=function(t,i,a){var n=l._getOutData(t),r=l.ajaxOperations.uploadBatch,o=l._parseError(r,t,a);l._showUploadError(o,n,"filebatchuploaderror"),l.uploadFileCount=d-1,l.showPreview&&(l._getThumbs().each((function(){var t=e(this),i=t.attr("data-fileindex");t.removeClass("file-uploading"),void 0!==l.filestack[i]&&l._setPreviewError(t)})),l._getThumbs().removeClass("file-uploading"),l._getThumbs(" .kv-file-upload").removeAttr("disabled"),l._getThumbs(" .kv-file-delete").removeAttr("disabled"),l._setProgress(101,l.$progress,l.msgAjaxProgressError.replace("{operation}",r)))},e.each(s,(function(e,i){t.isEmpty(s[e])||l.formdata.append(l.uploadFileAttr,i,l.filenames[e])})),l._ajaxSubmit(i,a,r,n))},_uploadExtraOnly:function(){var e,i,a,n,r=this,o={};r.formdata=new FormData,r._abort(o)||(e=function(e){r.lock();var t=r._getOutData(e);r._raise("filebatchpreupload",[t]),r._setProgress(50),o.data=t,o.xhr=e,r._abort(o)&&(e.abort(),r._setProgressCancelled())},i=function(e,i,a){var n=r._getOutData(a,e);t.isEmpty(e)||t.isEmpty(e.error)?(r._raise("filebatchuploadsuccess",[n]),r._clearFileInput(),r._initUploadSuccess(e),r._setProgress(101)):r._showUploadError(e.error,n,"filebatchuploaderror")},a=function(){r.unlock(),r._clearFileInput(),r._raise("filebatchuploadcomplete",[r.filestack,r._getExtraData()])},n=function(e,t,i){var a=r._getOutData(e),n=r.ajaxOperations.uploadExtra,l=r._parseError(n,e,i);o.data=a,r._showUploadError(l,a,"filebatchuploaderror"),r._setProgress(101,r.$progress,r.msgAjaxProgressError.replace("{operation}",n))},r._ajaxSubmit(e,i,a,n))},_deleteFileIndex:function(i){var a=this,n=i.attr("data-fileindex");"init_"===n.substring(0,5)&&(n=A(n.replace("init_","")),a.initialPreview=t.spliceArray(a.initialPreview,n),a.initialPreviewConfig=t.spliceArray(a.initialPreviewConfig,n),a.initialPreviewThumbTags=t.spliceArray(a.initialPreviewThumbTags,n),a.getFrames().each((function(){var t=e(this),i=t.attr("data-fileindex");"init_"===i.substring(0,5)&&(i=A(i.replace("init_","")))>n&&(i--,t.attr("data-fileindex","init_"+i))})),a.uploadAsync&&(a.cacheInitialPreview=a.getPreview()))},_initFileActions:function(){var i=this,a=i.$preview;i.showPreview&&(i._initZoomButton(),i.getFrames(" .kv-file-remove").each((function(){var n,r,o,l=e(this),s=l.closest(t.FRAMES),d=s.attr("id"),c=s.attr("data-fileindex");i._handler(l,"click",(function(){if(!1===i._raise("filepreremove",[d,c])||!i._validateMinCount())return!1;n=s.hasClass("file-preview-error"),t.cleanMemory(s),s.fadeOut("slow",(function(){t.cleanZoomCache(a.find("#zoom-"+d)),i.updateStack(c,void 0),i._clearObjects(s),s.remove(),d&&n&&i.$errorContainer.find('li[data-file-id="'+d+'"]').fadeOut("fast",(function(){e(this).remove(),i._errorsExist()||i._resetErrors()})),i._clearFileInput();var l=i.getFileStack(!0),p=i.previewCache.count(),u=l.length,f=i.showPreview&&i.getFrames().length;0!==u||0!==p||f?(o=(r=p+u)>1?i._getMsgSelected(r):l[0]?i._getFileNames()[0]:"",i._setCaption(o)):i.reset(),i._raise("fileremoved",[d,c])}))}))})),i.getFrames(" .kv-file-upload").each((function(){var a=e(this);i._handler(a,"click",(function(){var e=a.closest(t.FRAMES),n=e.attr("data-fileindex");i.$progress.hide(),e.hasClass("file-preview-error")&&!i.retryErrorUploads||i._uploadSingle(n,!1)}))})))},_initPreviewActions:function(){var i=this,a=i.$preview,n=i.deleteExtraData||{},r=t.FRAMES+" .kv-file-remove",o=i.fileActionSettings,l=o.removeClass,s=o.removeErrorClass,d=function(){var e=i.isAjaxUpload?i.previewCache.count():i.$element.get(0).files.length;a.find(t.FRAMES).length||e||(i._setCaption(""),i.reset(),i.initialCaption="")};i._initZoomButton(),a.find(r).each((function(){var r,o,c,p=e(this),u=p.data("url")||i.deleteUrl,f=p.data("key");if(!t.isEmpty(u)&&void 0!==f){var h,m,g,v,w=p.closest(t.FRAMES),b=i.previewCache.data,_=w.attr("data-fileindex");_=A(_.replace("init_","")),g=t.isEmpty(b.config)&&t.isEmpty(b.config[_])?null:b.config[_],"function"==typeof(v=t.isEmpty(g)||t.isEmpty(g.extra)?n:g.extra)&&(v=v()),m={id:p.attr("id"),key:f,extra:v},r=function(e){i.ajaxAborted=!1,i._raise("filepredelete",[f,e,v]),i._abort()?e.abort():(p.removeClass(s),t.addCss(w,"file-uploading"),t.addCss(p,"disabled "+l))},o=function(e,n,r){var o,c;if(!t.isEmpty(e)&&!t.isEmpty(e.error))return m.jqXHR=r,m.response=e,i._showError(e.error,m,"filedeleteerror"),w.removeClass("file-uploading"),p.removeClass("disabled "+l).addClass(s),void d();w.removeClass("file-uploading").addClass("file-deleted"),w.fadeOut("slow",(function(){_=A(w.attr("data-fileindex").replace("init_","")),i.previewCache.unset(_),o=i.previewCache.count(),c=o>0?i._getMsgSelected(o):"",i._deleteFileIndex(w),i._setCaption(c),i._raise("filedeleted",[f,r,v]),t.cleanZoomCache(a.find("#zoom-"+w.attr("id"))),i._clearObjects(w),w.remove(),d()}))},c=function(e,t,a){var n=i.ajaxOperations.deleteThumb,r=i._parseError(n,e,a);m.jqXHR=e,m.response={},i._showError(r,m,"filedeleteerror"),w.removeClass("file-uploading"),p.removeClass("disabled "+l).addClass(s),d()},i._mergeAjaxCallback("beforeSend",r,"delete"),i._mergeAjaxCallback("success",o,"delete"),i._mergeAjaxCallback("error",c,"delete"),h=e.extend(!0,{},{url:u,type:"POST",dataType:"json",data:JSON.stringify(e.extend(!0,{},{key:f},v))},i.ajaxDeleteSettings),i._handler(p,"click",(function(){if(!i._validateMinCount())return!1;i.ajaxAborted=!1,i._raise("filebeforedelete",[f,v]),i.ajaxAborted instanceof Promise?i.ajaxAborted.then((function(t){t||e.ajax(h)})):i.ajaxAborted||e.ajax(h)}))}})),i.getFrames(" .kv-file-download").each((function(){var t=e(this);i._handler(t,"click",(function(){var e=F.createElement("a");e.href=t.attr("data-url"),e.download=t.attr("data-caption"),e.target="_blank",e.click()}))}))},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.removeClass("icon-visible")},_showFileIcon:function(){t.addCss(this.$captionContainer,"icon-visible")},_getSize:function(t){var i,a,n,r=parseFloat(t),o=this.fileSizeGetter;return e.isNumeric(t)&&e.isNumeric(r)?("function"==typeof o?n=o(r):0===r?n="0.00 B":(i=Math.floor(Math.log(r)/Math.log(1024)),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=1*(r/Math.pow(1024,i)).toFixed(2)+" "+a[i]),this._getLayoutTemplate("size").replace("{sizeText}",n)):""},_generatePreviewTemplate:function(i,a,n,r,o,l,s,d,c,p,u){var f,h=this,m=h.slug(n),g="",v="",w=(window.innerWidth||F.documentElement.clientWidth||F.body.clientWidth)<400?h.previewSettingsSmall[i]||h.defaults.previewSettingsSmall[i]:h.previewSettings[i]||h.defaults.previewSettings[i],b=c||h._renderFileFooter(m,s,"auto",l),_=h._getPreviewIcon(n),y="type-default",C=_&&h.preferIconicPreview,x=_&&h.preferIconicZoomPreview;return w&&e.each(w,(function(e,t){v+=e+":"+t+";"})),f=function(a,l,s,c){var f=s?"zoom-"+o:o,g=h._getPreviewTemplate(a),w=(d||"")+" "+c;return h.frameClass&&(w=h.frameClass+" "+w),s&&(w=w.replace(" "+t.SORT_CSS,"")),g=h._parseFilePreviewIcon(g,n),"text"===a&&(l=t.htmlEncode(l)),"object"!==i||r||e.each(h.defaults.fileTypeSettings,(function(e,t){"object"!==e&&"other"!==e&&t(n,r)&&(y="type-"+e)})),g.setTokens({previewId:f,caption:m,frameClass:w,type:r,fileindex:p,typeCss:y,footer:b,data:l,template:u||i,style:v?'style="'+v+'"':""})},p=p||o.slice(o.lastIndexOf("-")+1),h.fileActionSettings.showZoom&&(g=f(x?"other":i,a,!0,"kv-zoom-thumb")),g="\n"+h._getLayoutTemplate("zoomCache").replace("{zoomContent}",g),f(C?"other":i,a,!1,"kv-preview-thumb")+g},_previewDefault:function(i,a,n){var r=this,o=r.$preview;if(r.showPreview){var l,s=i?i.name:"",d=i?i.type:"",c=i.size||0,p=r.slug(s),u=!0===n&&!r.isAjaxUpload,f=t.objUrl.createObjectURL(i);r._clearDefaultPreview(),l=r._generatePreviewTemplate("other",f,s,d,a,u,c),o.append("\n"+l),r._setThumbAttr(a,p,c),!0===n&&r.isAjaxUpload&&r._setThumbStatus(e("#"+a),"Error")}},_previewFile:function(e,i,a,n,r,o){if(this.showPreview){var l,s=this,d=i?i.name:"",c=o.type,p=o.name,u=s._parseFileType(c,d),f=s.allowedPreviewTypes,h=s.allowedPreviewMimeTypes,m=s.$preview,g=i.size||0,v=f&&f.indexOf(u)>=0,w=h&&-1!==h.indexOf(c),b="text"===u||"html"===u||"image"===u?a.target.result:r;if("html"===u&&s.purifyHtml&&window.DOMPurify&&(b=window.DOMPurify.sanitize(b)),v||w){l=s._generatePreviewTemplate(u,b,d,c,n,!1,g),s._clearDefaultPreview(),m.append("\n"+l);var _=m.find("#"+n+" img");_.length&&s.autoOrientImage?t.validateOrientation(i,(function(e){if(e){var a=m.find("#zoom-"+n+" img"),r="rotate-"+e;e>4&&(r+=_.width()>_.height()?" is-portrait-gt4":" is-landscape-gt4"),t.addCss(_,r),t.addCss(a,r),s._raise("fileimageoriented",{$img:_,file:i}),s._validateImage(n,p,c,g,b),t.adjustOrientedImage(_)}else s._validateImage(n,p,c,g,b)})):s._validateImage(n,p,c,g,b)}else s._previewDefault(i,n);s._setThumbAttr(n,p,g),s._initSortable()}},_setThumbAttr:function(t,i,a){var n=e("#"+t);n.length&&(a=a&&a>0?this._getSize(a):"",n.data({caption:i,size:a}))},_setInitThumbAttr:function(){var e,i,a,n,r=this,o=r.previewCache.data,l=r.previewCache.count();if(0!==l)for(var s=0;s<l;s++)e=o.config[s],n=r.previewInitId+"-init_"+s,i=t.ifSet("caption",e,t.ifSet("filename",e)),a=t.ifSet("size",e),r._setThumbAttr(n,i,a)},_slugDefault:function(e){return t.isEmpty(e)?"":String(e).replace(/[\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_updateFileDetails:function(e){var i=this,a=i.$element,n=i.getFileStack(),r=t.isIE(9)&&t.findFileName(a.val())||a[0].files[0]&&a[0].files[0].name||n.length&&n[0].name||"",o=i.slug(r),l=i.isAjaxUpload?n.length:e,s=i.previewCache.count()+l,d=1===l?o:i._getMsgSelected(s);i.isError?(i.$previewContainer.removeClass("file-thumb-loading"),i.$previewStatus.html(""),i.$captionContainer.removeClass("icon-visible")):i._showFileIcon(),i._setCaption(d,i.isError),i.$container.removeClass("file-input-new file-input-ajax-new"),1===arguments.length&&i._raise("fileselect",[e,o]),i.previewCache.count()&&i._initPreviewActions()},_setThumbStatus:function(e,t){var i=this;if(i.showPreview){var a="indicator"+t,n=a+"Title",r="file-preview-"+t.toLowerCase(),o=e.find(".file-upload-indicator"),l=i.fileActionSettings;e.removeClass("file-preview-success file-preview-error file-preview-loading"),"Success"===t&&e.find(".file-drag-handle").remove(),o.html(l[a]),o.attr("title",l[n]),e.addClass(r),"Error"!==t||i.retryErrorUploads||e.find(".kv-file-upload").attr("disabled",!0)}},_setProgressCancelled:function(){var e=this;e._setProgress(101,e.$progress,e.msgCancelled)},_setProgress:function(e,i,a){var n,r=this,o=Math.min(e,100),l=r.progressUploadThreshold,s=e<=100?r.progressTemplate:r.progressCompleteTemplate,d=o<100?r.progressTemplate:a?r.progressErrorTemplate:s;i=i||r.$progress,t.isEmpty(d)||(n=l&&o>l&&e<=100?d.setTokens({percent:l,status:r.msgUploadThreshold}):d.setTokens({percent:o,status:e>100?r.msgUploadEnd:o+"%"}),i.html(n),a&&i.find('[role="progressbar"]').html(a))},_setFileDropZoneTitle:function(){var e,i=this,a=i.$container.find(".file-drop-zone"),n=i.dropZoneTitle;i.isClickable&&(e=t.isEmpty(i.$element.attr("multiple"))?i.fileSingle:i.filePlural,n+=i.dropZoneClickTitle.replace("{files}",e)),a.find("."+i.dropZoneTitleClass).remove(),i.isAjaxUpload&&i.showPreview&&0!==a.length&&!(i.getFileStack().length>0)&&i.dropZoneEnabled&&(0===a.find(t.FRAMES).length&&t.isEmpty(i.defaultPreviewContent)&&a.prepend('<div class="'+i.dropZoneTitleClass+'">'+n+"</div>"),i.$container.removeClass("file-input-new"),t.addCss(i.$container,"file-input-ajax-new"))},_setAsyncUploadStatus:function(t,i,a){var n=this,r=0;n._setProgress(i,e("#"+t).find(".file-thumb-progress")),n.uploadStatus[t]=i,e.each(n.uploadStatus,(function(e,t){r+=t})),n._setProgress(Math.floor(r/a))},_validateMinCount:function(){var e=this,t=e.isAjaxUpload?e.getFileStack().length:e.$element.get(0).files.length;return!(e.validateInitialCount&&e.minFileCount>0&&e._getFileCount(t-1)<e.minFileCount)||(e._noFilesError({}),!1)},_getFileCount:function(e){var t=this;return t.validateInitialCount&&!t.overwriteInitial&&(e+=t.previewCache.count()),e},_getFileId:function(e){var t,i=this.generateFileId;return"function"==typeof i?i(e,event):e&&(t=String(e.webkitRelativePath||e.fileName||e.name||null))?e.size+"-"+t.replace(/[^0-9a-zA-Z_-]/gim,""):null},_getFileName:function(e){return e&&e.name?this.slug(e.name):void 0},_getFileIds:function(e){return this.fileids.filter((function(t){return e?void 0!==t:null!=t}))},_getFileNames:function(e){return this.filenames.filter((function(t){return e?void 0!==t:null!=t}))},_setPreviewError:function(e,t,i,a){var n=this;void 0!==t&&n.updateStack(t,i),n.showPreview&&(!n.removeFromPreviewOnError||a?(n._setThumbStatus(e,"Error"),n._refreshUploadButton(e,a)):e.remove())},_refreshUploadButton:function(e,t){var i=e.find(".kv-file-upload"),a=this.fileActionSettings,n=a.uploadIcon,r=a.uploadTitle;i.length&&(t&&(n=a.uploadRetryIcon,r=a.uploadRetryTitle),i.attr("title",r).html(n))},_checkDimensions:function(e,i,a,n,r,o,l){var s,d,c,p=this,u=p[("Small"===i?"min":"max")+"Image"+o];!t.isEmpty(u)&&a.length&&(c=a[0],d="Width"===o?c.naturalWidth||c.width:c.naturalHeight||c.height,("Small"===i?d>=u:d<=u)||(s=p["msgImage"+o+i].setTokens({name:r,size:u}),p._showUploadError(s,l),p._setPreviewError(n,e,null)))},_validateImage:function(t,i,a,n,r){var o,l,s,d,c=this,p=c.$preview,u=p.find("#"+t),f=u.attr("data-fileindex"),h=u.find("img");i=i||"Untitled",h.one("load",(function(){l=u.width(),s=p.width(),l>s&&h.css("width","100%"),o={ind:f,id:t},c._checkDimensions(f,"Small",h,u,i,"Width",o),c._checkDimensions(f,"Small",h,u,i,"Height",o),c.resizeImage||(c._checkDimensions(f,"Large",h,u,i,"Width",o),c._checkDimensions(f,"Large",h,u,i,"Height",o)),c._raise("fileimageloaded",[t]);try{d=window.piexif?window.piexif.load(r):null}catch(e){d=null}c.loadedImages.push({ind:f,img:h,thumb:u,pid:t,typ:a,siz:n,validated:!1,imgData:r,exifObj:d}),u.data("exif",d),c._validateAllImages()})).one("error",(function(){c._raise("fileimageloaderror",[t])})).each((function(){this.complete?e(this).trigger("load"):this.error&&e(this).trigger("error")}))},_validateAllImages:function(){var e,t,i,a=this,n={val:0},r=a.loadedImages.length,o=a.resizeIfSizeMoreThan;if(r===a.totalImagesCount&&(a._raise("fileimagesloaded"),a.resizeImage))for(e=0;e<a.loadedImages.length;e++)(t=a.loadedImages[e]).validated||((i=t.siz)&&i>1e3*o&&a._getResizedImage(t,n,r),a.loadedImages[e].validated=!0)},_getResizedImage:function(i,a,n){var r,o,l,s,d,c,p=this,u=e(i.img)[0],f=u.naturalWidth,h=u.naturalHeight,m=1,g=p.maxImageWidth||f,v=p.maxImageHeight||h,w=!(!f||!h),b=p.imageCanvas,_=p.imageCanvasContext,y=i.typ,C=i.pid,x=i.ind,T=i.thumb,E=i.exifObj;if(d=function(e,t,i){p.isAjaxUpload?p._showUploadError(e,t,i):p._showError(e,t,i),p._setPreviewError(T,x)},p.filestack[x]&&w&&!(f<=g&&h<=v)||(w&&p.filestack[x]&&p._raise("fileimageresized",[C,x]),a.val++,a.val===n&&p._raise("fileimagesresized"),w)){y=y||p.resizeDefaultImageType,o=f>g,l=h>v,m="width"===p.resizePreference?o?g/f:l?v/h:1:l?v/h:o?g/f:1,p._resetCanvas(),f*=m,h*=m,b.width=f,b.height=h;try{_.drawImage(u,0,0,f,h),s=b.toDataURL(y,p.resizeQuality),E&&(c=window.piexif.dump(E),s=window.piexif.insert(c,s)),r=t.dataURI2Blob(s),p.filestack[x]=r,p._raise("fileimageresized",[C,x]),a.val++,a.val===n&&p._raise("fileimagesresized",[void 0,void 0]),r instanceof Blob||d(p.msgImageResizeError,{id:C,index:x},"fileimageresizeerror")}catch(e){a.val++,a.val===n&&p._raise("fileimagesresized",[void 0,void 0]),d(p.msgImageResizeException.replace("{errors}",e.message),{id:C,index:x},"fileimageresizeexception")}}else d(p.msgImageResizeError,{id:C,index:x},"fileimageresizeerror")},_initBrowse:function(e){var t=this;t.showBrowse?(t.$btnFile=e.find(".btn-file"),t.$btnFile.append(t.$element)):t.$element.hide()},_initCapture:function(e){var t=this;t.showCapture?(t.$btnCapture=e.find(".btn-capture"),t.$btnCapture.append(t.$element)):t.$element.hide()},_initFileURL:function(e){var t=this;t.showFileURL?(t.$btnFileURL=e.find(".btn-file-url"),t.$btnFileURL.append(t.$element)):t.$element.hide()},_initCaption:function(){var e=this,i=e.initialCaption||"";return e.overwriteInitial||t.isEmpty(i)?(e.$caption.val(""),!1):(e._setCaption(i),!0)},_setCaption:function(i,a){var n,r,o,l,s,d=this,c=d.getFileStack();if(d.$caption.length){if(d.$captionContainer.removeClass("icon-visible"),a)n=e("<div>"+d.msgValidationError+"</div>").text(),s=(l=c.length)?1===l&&c[0]?d._getFileNames()[0]:d._getMsgSelected(l):d._getMsgSelected(d.msgNo),r=t.isEmpty(i)?s:i,o='<span class="'+d.msgValidationErrorClass+'">'+d.msgValidationErrorIcon+"</span>";else{if(t.isEmpty(i))return;r=n=e("<div>"+i+"</div>").text(),o=d._getLayoutTemplate("fileIcon")}d.$captionContainer.addClass("icon-visible"),d.$caption.attr("title",n).val(r),d.$captionIcon.html(o)}},_createContainer:function(){var t=this,i={class:"file-input file-input-new"+(t.rtl?" kv-rtl":"")},a=e(F.createElement("div")).attr(i).html(t._renderMain());return t.$element.before(a),t._initBrowse(a),t.theme&&a.addClass("theme-"+t.theme),a},_refreshContainer:function(){var e=this,t=e.$container;t.before(e.$element),t.html(e._renderMain()),e._initBrowse(t),e._validateDisabled()},_validateDisabled:function(){this.$caption.attr({readonly:this.isDisabled})},_renderMain:function(){var e=this,t=e.isAjaxUpload&&e.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",i=e.showClose?e._getLayoutTemplate("close"):"",a=e.showPreview?e._getLayoutTemplate("preview").setTokens({class:e.previewClass,dropClass:t}):"",n=e.isDisabled?e.captionClass+" file-caption-disabled":e.captionClass,r=e.captionTemplate.setTokens({class:n+" kv-fileinput-caption"});return e.mainTemplate.setTokens({class:e.mainClass+(!e.showBrowse&&e.showCaption?" no-browse":""),preview:a,close:i,caption:r,upload:e._renderButton("upload"),remove:e._renderButton("remove"),cancel:e._renderButton("cancel"),browse:e._renderButton("browse"),capture:e._renderButton("capture"),fileURL:e._renderButton("fileURL")})},_renderButton:function(e){var i=this,a=i._getLayoutTemplate("btnDefault"),n=i[e+"Class"],r=i[e+"Title"],o=i[e+"Icon"],l=i[e+"Label"],s=i.isDisabled?" disabled":"",d="button";switch(e){case"remove":if(!i.showRemove)return"";break;case"cancel":if(!i.showCancel)return"";n+=" kv-hidden";break;case"upload":if(!i.showUpload)return"";i.isAjaxUpload&&!i.isDisabled?a=i._getLayoutTemplate("btnLink").replace("{href}",i.uploadUrl):d="submit";break;case"browse":if(!i.showBrowse)return"";a=i._getLayoutTemplate("btnBrowse");break;case"capture":if(!i.showCapture)return"";a=i._getLayoutTemplate("btnCapture");break;case"fileURL":if(!i.showFileURL)return"";a=i._getLayoutTemplate("btnFileURL");break;default:return""}return n+="browse"===e?" btn-file":" fileinput-"+e+" fileinput-"+e+"-button",t.isEmpty(l)||(l=' <span class="'+i.buttonLabelClass+'">'+l+"</span>"),a.setTokens({type:d,css:n,title:r,status:s,icon:o,label:l})},_renderThumbProgress:function(){return'<div class="file-thumb-progress kv-hidden">'+this.progressTemplate.setTokens({percent:"0",status:this.msgUploadBegin})+"</div>"},_renderFileFooter:function(e,i,a,n){var r,o=this,l=o.fileActionSettings,s=l.showRemove,d=l.showDrag,c=l.showUpload,p=l.showZoom,u=o._getLayoutTemplate("footer"),f=o._getLayoutTemplate("indicator"),h=n?l.indicatorError:l.indicatorNew,m=n?l.indicatorErrorTitle:l.indicatorNewTitle,g=f.setTokens({indicator:h,indicatorTitle:m});return i=o._getSize(i),r=o.isAjaxUpload?u.setTokens({actions:o._renderFileActions(c,!1,s,p,d,!1,!1,!1),caption:e,size:i,width:a,progress:o._renderThumbProgress(),indicator:g}):u.setTokens({actions:o._renderFileActions(!1,!1,!1,p,d,!1,!1,!1),caption:e,size:i,width:a,progress:"",indicator:g}),r=t.replaceTags(r,o.previewThumbTags)},_renderFileActions:function(e,t,i,a,n,r,o,l,s,d,c){if(!(e||t||i||a||n))return"";var p,u=this,f=!1===o?"":' data-url="'+o+'"',h=!1===l?"":' data-key="'+l+'"',m="",g="",v="",w="",b="",_=u._getLayoutTemplate("actions"),y=u.fileActionSettings,C=u.otherActionButtons.setTokens({dataKey:h,key:l}),x=r?y.removeClass+" disabled":y.removeClass;return i&&(m=u._getLayoutTemplate("actionDelete").setTokens({removeClass:x,removeIcon:y.removeIcon,removeTitle:y.removeTitle,dataUrl:f,dataKey:h,key:l})),e&&(g=u._getLayoutTemplate("actionUpload").setTokens({uploadClass:y.uploadClass,uploadIcon:y.uploadIcon,uploadTitle:y.uploadTitle})),t&&(v=(v=u._getLayoutTemplate("actionDownload").setTokens({downloadClass:y.downloadClass,downloadIcon:y.downloadIcon,downloadTitle:y.downloadTitle,downloadUrl:d||u.initialPreviewDownloadUrl})).setTokens({filename:c,key:l})),a&&(w=u._getLayoutTemplate("actionZoom").setTokens({zoomClass:y.zoomClass,zoomIcon:y.zoomIcon,zoomTitle:y.zoomTitle})),n&&s&&(p="drag-handle-init "+y.dragClass,b=u._getLayoutTemplate("actionDrag").setTokens({dragClass:p,dragTitle:y.dragTitle,dragIcon:y.dragIcon})),_.setTokens({delete:m,upload:g,download:v,zoom:w,drag:b,other:C})},_browse:function(e){var t=this;t._raise("filebrowse"),e&&e.isDefaultPrevented()||(t.isError&&!t.isAjaxUpload&&t.clear(),t.$captionContainer.focus())},_capture:function(e){App.CameraController?App.CameraController.do_lc_show(this,this.isCaptureAvatar):alert("Missing Camera plugin, please install it!")},_fileURL:function(e){App.FileURLController?App.FileURLController.do_lc_show(this):alert("Missing FileURL plugin, please install it!")},_filterDuplicate:function(e,t,i){var a=this._getFileId(e);a&&i&&i.indexOf(a)>-1||(i||(i=[]),t.push(e),i.push(a))},_change:function(i){var a=this,n=a.$element;if(!a.isAjaxUpload&&t.isEmpty(n.val())&&a.fileInputCleared)a.fileInputCleared=!1;else{a.fileInputCleared=!1;var r,o,l,s,d,c,p,u,f,h,m=[],g=arguments.length>1,v=a.isAjaxUpload,w=g?i.originalEvent.dataTransfer.files:n.get(0).files,b=a.filestack.length,_=t.isEmpty(n.attr("multiple"))&&b>0,y=0,C=a._getFileIds();if(a.reader=null,a._resetUpload(),a._hideFileIcon(),a.isAjaxUpload&&a.$container.find(".file-drop-zone ."+a.dropZoneTitleClass).remove(),g?e.each(w,(function(e,t){t&&!t.type&&void 0!==t.size&&t.size%4096==0?y++:a._filterDuplicate(t,m,C)})):(w=i.target&&void 0===i.target.files?i.target.value?[{name:i.target.value.replace(/^.+\\/,"")}]:[]:i.target.files||{},v?e.each(w,(function(e,t){a._filterDuplicate(t,m,C)})):m=w),t.isEmpty(m)||0===m.length)return v||a.clear(),a._showFolderError(y),void a._raise("fileselectnone");if(a._resetErrors(),s=m.length,o=a._getFileCount(a.isAjaxUpload?a.getFileStack().length+s:s),a.maxFileCount>0&&o>a.maxFileCount){if(!a.autoReplace||s>a.maxFileCount)return l=a.autoReplace&&s>a.maxFileCount?s:o,r=a.msgFilesTooMany.replace("{m}",a.maxFileCount).replace("{n}",l),a.isError=(d=r,c=null,p=null,u=null,f=e.extend(!0,{},a._getOutData({},{},w),{id:p,index:u}),h={id:p,index:u,file:c,files:w},a.isAjaxUpload?a._showUploadError(d,f):a._showError(d,h)),a.$captionContainer.removeClass("icon-visible"),a._setCaption("",!0),void a.$container.removeClass("file-input-new file-input-ajax-new");o>a.maxFileCount&&a._resetPreviewThumbs(v)}else!v||_?(a._resetPreviewThumbs(!1),_&&a.clearStack()):!v||0!==b||a.previewCache.count()&&!a.overwriteInitial||a._resetPreviewThumbs(!0);a.isPreviewable?a.readFiles(m):a._updateFileDetails(1),a._showFolderError(y)}},_abort:function(t){var i,a=this;return a.ajaxAborted&&"object"==typeof a.ajaxAborted&&void 0!==a.ajaxAborted.message?((i=e.extend(!0,{},a._getOutData(),t)).abortData=a.ajaxAborted.data||{},i.abortMessage=a.ajaxAborted.message,a._setProgress(101,a.$progress,a.msgCancelled),a._showUploadError(a.ajaxAborted.message,i,"filecustomerror"),a.cancel(),!0):!!a.ajaxAborted},_resetFileStack:function(){var i=this,a=0,n=[],r=[],o=[];i._getThumbs().each((function(){var l,s=e(this),d=s.attr("data-fileindex"),c=i.filestack[d],p=s.attr("id");"-1"!==d&&-1!==d&&(void 0!==c?(n[a]=c,r[a]=i._getFileName(c),o[a]=i._getFileId(c),s.attr({id:i.previewInitId+"-"+a,"data-fileindex":a}),a++):(l="uploaded-"+t.uniqId(),s.attr({id:l,"data-fileindex":"-1"}),i.$preview.find("#zoom-"+p).attr("id","zoom-"+l)))})),i.filestack=n,i.filenames=r,i.fileids=o},_isFileSelectionValid:function(e){var t=this;return e=e||0,t.required&&!t.getFilesCount()?(t.$errorContainer.html(""),t._showUploadError(t.msgFileRequired),!1):!(t.minFileCount>0&&t._getFileCount(e)<t.minFileCount)||(t._noFilesError({}),!1)},clearStack:function(){var e=this;return e.filestack=[],e.filenames=[],e.fileids=[],e.$element},updateStack:function(e,t){var i=this;return i.filestack[e]=t,i.filenames[e]=i._getFileName(t),i.fileids[e]=t&&i._getFileId(t)||null,i.$element},addToStack:function(e){var t=this;return t.filestack.push(e),t.filenames.push(t._getFileName(e)),t.fileids.push(t._getFileId(e)),t.$element},getFileStack:function(e){return this.filestack.filter((function(t){return e?void 0!==t:null!=t}))},getFilesCount:function(){var e=this,t=e.isAjaxUpload?e.getFileStack().length:e.$element.get(0).files.length;return e._getFileCount(t)},readFiles:function(i){this.reader=new FileReader;var a,n=this,r=n.$element,o=n.$preview,l=n.reader,s=n.$previewContainer,d=n.$previewStatus,c=n.msgLoading,p=n.msgProgress,u=n.previewInitId,f=i.length,h=n.fileTypeSettings,m=n.filestack.length,g=n.allowedFileTypes,v=g?g.length:0,w=n.allowedFileExtensions,b=t.isEmpty(w)?"":w.join(", "),_=n.maxFilePreviewSize&&parseFloat(n.maxFilePreviewSize),y=o.length&&(!_||isNaN(_)),C=function(t,r,o,l){var s,d=e.extend(!0,{},n._getOutData({},{},i),{id:o,index:l}),c={id:o,index:l,file:r,files:i};n._previewDefault(r,o,!0),n.isAjaxUpload?(n.addToStack(void 0),P((function(){a(l+1)}),100)):f=0,n._initFileActions(),(s=e("#"+o)).find(".kv-file-upload").hide(),n.removeFromPreviewOnError&&s.remove(),n.isError=n.isAjaxUpload?n._showUploadError(t,d):n._showError(t,c),n._updateFileDetails(f)};n.loadedImages=[],n.totalImagesCount=0,e.each(i,(function(e,t){var i=n.fileTypeSettings.image;i&&i(t.type)&&n.totalImagesCount++})),(a=function(x){if(t.isEmpty(r.attr("multiple"))&&(f=1),x>=f)return n.isAjaxUpload&&n.filestack.length>0?n._raise("filebatchselected",[n.getFileStack()]):n._raise("filebatchselected",[i]),s.removeClass("file-thumb-loading"),void d.html("");var T,E,S,k,D,F,A,I,z,L,U,$,R=u+"-"+(m+x),j=i[x],B=h.text,O=h.image,M=h.html,N=j.name?n.slug(j.name):"",Z=(j.size||0)/1e3,H="",W=t.objUrl.createObjectURL(j),q=0,X="",Y=0,V=function(){var e=p.setTokens({index:x+1,files:f,percent:50,name:N});P((function(){d.html(e),n._updateFileDetails(f),a(x+1)}),100),n._raise("fileloaded",[j,R,x,l])};if(v>0)for(E=0;E<v;E++)F=g[E],A=n.msgFileTypes[F]||F,X+=0===E?A:", "+A;if(!1!==N){if(0===N.length)return S=n.msgInvalidFileName.replace("{name}",t.htmlEncode(j.name)),void C(S,j,R,x);if(t.isEmpty(w)||(H=new RegExp("\\.("+w.join("|")+")$","i")),T=Z.toFixed(2),n.maxFileSize>0&&Z>n.maxFileSize)return S=n.msgSizeTooLarge.setTokens({name:N,size:T,maxSize:n.maxFileSize}),void C(S,j,R,x);if(null!==n.minFileSize&&Z<=t.getNum(n.minFileSize))return S=n.msgSizeTooSmall.setTokens({name:N,size:T,minSize:n.minFileSize}),void C(S,j,R,x);if(!t.isEmpty(g)&&t.isArray(g)){for(E=0;E<g.length;E+=1)k=g[E],q+=(I=h[k])&&"function"==typeof I&&I(j.type,j.name)?1:0;if(0===q)return S=n.msgInvalidFileType.setTokens({name:N,types:X}),void C(S,j,R,x)}if(0===q&&!t.isEmpty(w)&&t.isArray(w)&&!t.isEmpty(H)&&(D=t.compare(N,H),0===(q+=t.isEmpty(D)?0:D.length)))return S=n.msgInvalidFileExtension.setTokens({name:N,extensions:b}),void C(S,j,R,x);if(!n.showPreview)return n.isAjaxUpload&&n.addToStack(j),P((function(){a(x+1),n._updateFileDetails(f)}),100),void n._raise("fileloaded",[j,R,x,l]);if(!y&&Z>_)return n.addToStack(j),s.addClass("file-thumb-loading"),n._previewDefault(j,R),n._initFileActions(),n._updateFileDetails(f),void a(x+1);o.length&&void 0!==FileReader?(z=B(j.type,N),L=M(j.type,N),U=O(j.type,N),d.html(c.replace("{index}",x+1).replace("{files}",f)),s.addClass("file-thumb-loading"),l.onerror=function(e){n._errorHandler(e,N)},l.onload=function(i){var a,r,o,s,d,c,p,u,f=[];if(r={name:N,type:j.type},e.each(h,(function(e,t){"object"!==e&&"other"!==e&&t(j.type,N)&&Y++})),0===Y){for(o=new Uint8Array(i.target.result),E=0;E<o.length;E++)s=o[E].toString(16),f.push(s);if(a=f.join("").toLowerCase().substring(0,8),c=t.getMimeType(a,"",""),t.isEmpty(c)&&(d=t.arrayBuffer2String(l.result),c=t.isSvg(d)?"image/svg+xml":t.getMimeType(a,d,j.type)),r={name:N,type:c},z=B(c,""),L=M(c,""),U=O(c,""),($=z||L)||U)return p=$,(u=new FileReader).onerror=function(e){n._errorHandler(e,N)},u.onload=function(e){n._previewFile(x,j,e,R,W,r),n._initFileActions(),V()},void(p?u.readAsText(j,n.textEncoding):u.readAsDataURL(j))}n._previewFile(x,j,i,R,W,r),n._initFileActions(),V()},l.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100,i=Math.ceil(t);S=p.setTokens({index:x+1,files:f,percent:i,name:N}),P((function(){d.html(S)}),100)}},z||L?l.readAsText(j,n.textEncoding):U?l.readAsDataURL(j):l.readAsArrayBuffer(j)):(n._previewDefault(j,R),P((function(){a(x+1),n._updateFileDetails(f)}),100),n._raise("fileloaded",[j,R,x,l])),n.addToStack(j)}else a(x+1)})(0),n._updateFileDetails(f,!1)},lock:function(){var e=this;return e._resetErrors(),e.disable(),e.showRemove&&e.$container.find(".fileinput-remove").hide(),e.showCancel&&e.$container.find(".fileinput-cancel").show(),e._raise("filelock",[e.filestack,e._getExtraData()]),e.$element},unlock:function(e){var t=this;return void 0===e&&(e=!0),t.enable(),t.showCancel&&t.$container.find(".fileinput-cancel").hide(),t.showRemove&&t.$container.find(".fileinput-remove").show(),e&&t._resetFileStack(),t._raise("fileunlock",[t.filestack,t._getExtraData()]),t.$element},cancel:function(){var t,i=this,a=i.ajaxRequests,n=a.length;if(n>0)for(t=0;t<n;t+=1)i.cancelling=!0,a[t].abort();return i._setProgressCancelled(),i._getThumbs().each((function(){var t=e(this),a=t.attr("data-fileindex");t.removeClass("file-uploading"),void 0!==i.filestack[a]&&(t.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),t.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),i.unlock()})),i.$element},clear:function(){var i,a=this;if(a._raise("fileclear"))return a.$btnUpload.removeAttr("disabled"),a._getThumbs().find("video,audio,img").each((function(){t.cleanMemory(e(this))})),a._resetUpload(),a.clearStack(),a._clearFileInput(),a._resetErrors(!0),a._hasInitialPreview()?(a._showFileIcon(),a._resetPreview(),a._initPreviewActions(),a.$container.removeClass("file-input-new")):(a._getThumbs().each((function(){a._clearObjects(e(this))})),a.isAjaxUpload&&(a.previewCache.data={}),a.$preview.html(""),i=!a.overwriteInitial&&a.initialCaption.length>0?a.initialCaption:"",a.$caption.attr("title","").val(i),t.addCss(a.$container,"file-input-new"),a._validateDefaultPreview()),0===a.$container.find(t.FRAMES).length&&(a._initCaption()||a.$captionContainer.removeClass("icon-visible")),a._hideFileIcon(),a._raise("filecleared"),a.$captionContainer.focus(),a._setFileDropZoneTitle(),a.$element},reset:function(){var e=this;if(e._raise("filereset"))return e._resetPreview(),e.$container.find(".fileinput-filename").text(""),t.addCss(e.$container,"file-input-new"),(e.getFrames().length||e.isAjaxUpload&&e.dropZoneEnabled)&&e.$container.removeClass("file-input-new"),e.clearStack(),e.formdata={},e._setFileDropZoneTitle(),e.$element},disable:function(){var e=this;return e.isDisabled=!0,e._raise("filedisabled"),e.$element.attr("disabled","disabled"),e.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled"),e.$container.find(".kv-file-remove, .file-caption-main").hide(),t.addCss(e.$container.find(".btn-file"),"disabled"),e._initDragDrop(),e.$element},enable:function(){var e=this;return e.isDisabled=!1,e._raise("fileenabled"),e.$element.removeAttr("disabled"),e.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),e.$container.find(".kv-file-remove, .file-caption-main").show(),e.$container.find(".btn-file").removeClass("disabled"),e._initDragDrop(),e.$element},upload:function(){var i,a,n,r=this,o=r.getFileStack().length,l=!e.isEmptyObject(r._getExtraData());if(r.isAjaxUpload&&!r.isDisabled&&r._isFileSelectionValid(o))if(r._resetUpload(),0!==o||l)if(r.$progress.show(),r.uploadCount=0,r.uploadStatus={},r.uploadLog=[],r.lock(),r._setProgress(2),0===o&&l)r._uploadExtraOnly();else{if(n=r.filestack.length,r.hasInitData=!1,!r.uploadAsync)return r._uploadBatch(),r.$element;for(a=r._getOutData(),r._raise("filebatchpreupload",[a]),r.fileBatchCompleted=!1,r.uploadCache={content:[],config:[],tags:[],append:!0},r.uploadAsyncCount=r.getFileStack().length,i=0;i<n;i++)r.uploadCache.content[i]=null,r.uploadCache.config[i]=null,r.uploadCache.tags[i]=null;for(r.$preview.find(".file-preview-initial").removeClass(t.SORT_CSS),r._initSortable(),r.cacheInitialPreview=r.getPreview(),i=0;i<n;i++)r.filestack[i]&&r._uploadSingle(i,!0)}else r._showUploadError(r.msgUploadEmpty)},destroy:function(){var t=this,i=t.$form,a=t.$container,n=t.$element,r=t.namespace;return e(F).off(r),e(window).off(r),i&&i.length&&i.off(r),t.isAjaxUpload&&t._clearFileInput(),t._cleanup(),t._initPreviewCache(),n.insertBefore(a).off(r).removeData(),a.off().remove(),n},refresh:function(i,a){var n=this,r=n.$element;return i="object"!=typeof i||t.isEmpty(i)?n.options:e.extend(!0,{},n.options,i),n._init(i,!0),n._listen(),a&&r.trigger("change"+n.namespace),r},zoom:function(e){var i=this,a=i._getFrame(e),n=i.$modal;a&&(t.initModal(n),n.html(i._getModalContent()),i._setZoomContent(a),n.modal("show"),i._initZoomButtons())},getExif:function(e){var t=this._getFrame(e);return t&&t.data("exif")||null},getFrames:function(e){return e=e||"",this.$preview.find(t.FRAMES+e)},getPreview:function(){var e=this;return{content:e.initialPreview,config:e.initialPreviewConfig,tags:e.initialPreviewThumbTags}}},e.fn.fileinput=function(a){if(t.hasFileAPISupport()||t.isIE(9)){var n=Array.apply(null,arguments),r=[];switch(n.shift(),this.each((function(){var o,l=e(this),s=l.data("fileinput"),d="object"==typeof a&&a,c=d.theme||l.data("theme"),p={},u={},f=d.language||l.data("language")||e.fn.fileinput.defaults.language||"en";s||(c&&(u=e.fn.fileinputThemes[c]||{}),"en"===f||t.isEmpty(e.fn.fileinputLocales[f])||(p=e.fn.fileinputLocales[f]||{}),o=e.extend(!0,{},e.fn.fileinput.defaults,u,e.fn.fileinputLocales.en,p,d,l.data()),s=new i(this,o),l.data("fileinput",s)),"string"==typeof a&&r.push(s[a].apply(s,n))})),r.length){case 0:return this;case 1:return r[0];default:return r}}},e.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showCapture:!0,isCaptureAvatar:!1,showFileURL:!0,showPreview:!0,showRemove:!0,showUpload:!0,showCancel:!0,showClose:!0,showUploadedThumbs:!0,browseOnZoneClick:!1,autoReplace:!1,autoOrientImage:!0,required:!1,rtl:!1,hideThumbnailContent:!1,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,purifyHtml:!0,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,initialPreviewDownloadUrl:"",removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-kv btn-default btn-outline-secondary",fullscreen:"btn btn-kv btn-default btn-outline-secondary",borderless:"btn btn-kv btn-default btn-outline-secondary",close:"btn btn-kv btn-default btn-outline-secondary"},preferIconicPreview:!1,preferIconicZoomPreview:!1,allowedPreviewTypes:void 0,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",captureIcon:'<i class="glyphicon glyphicon-camera"></i>',captureClass:"btn btn-primary btn-danger",fileURLIcon:'<i class="glyphicon glyphicon-picture"></i>',fileURLClass:"btn btn-primary btn-success",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default btn-secondary",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default btn-secondary",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default btn-secondary",uploadUrl:null,uploadUrlThumb:null,uploadAsync:!0,uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:0,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar bg-success progress-bar-success",progressErrorClass:"progress-bar bg-danger progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:t.closeButton("kv-error-close"),slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0,mergeAjaxCallbacks:!1,mergeAjaxDeleteCallbacks:!1,retryErrorUploads:!0},e.fn.fileinputLocales.vi={fileSingle:"tập tin",filePlural:"các tập tin",browseLabel:"",captureLabel:"",fileURLLabel:"",removeLabel:"",removeTitle:"Bỏ tập tin đã chọn",cancelLabel:"Hủy",cancelTitle:"Hủy tải lên",uploadLabel:"Tải lên",uploadTitle:"Tải lên tập tin đã chọn",msgNo:"Không",msgNoFilesSelected:"Không tập tin nào được chọn",msgCancelled:"Đã hủy",msgPlaceholder:"Chọn {files}...",msgZoomModalHeading:"Chi tiết xem trước",msgFileRequired:"Bạn phải chọn một tệp để tải lên.",msgSizeTooSmall:'Tệp "{name}" (<b>{size} KB</b>) quá nhỏ và phải lớn hơn <b>{minSize} KB</b>.',msgSizeTooLarge:'Tập tin "{name}" (<b>{size} KB</b>) vượt quá kích thước giới hạn cho phép <b>{maxSize} KB</b>.',msgFilesTooLess:"Bạn phải chọn ít nhất <b>{n}</b> {files} để upload.",msgFilesTooMany:"Số lượng tập tin tải lên <b>({n})</b> vượt quá giới hạn cho phép là <b>{m}</b>.",msgFileNotFound:'Không tìm thấy tập tin "{name}"!',msgFileSecured:'Các hạn chế về bảo mật không cho phép đọc tập tin "{name}".',msgFileNotReadable:'Không đọc được tập tin "{name}".',msgFilePreviewAborted:'Đã dừng xem trước tập tin "{name}".',msgFilePreviewError:'Đã xảy ra lỗi khi đọc tập tin "{name}".',msgInvalidFileName:'Ký tự không hợp lệ hoặc không được hỗ trợ trong tên tệp "{name}".',msgInvalidFileType:'Tập tin "{name}" không hợp lệ. Chỉ hỗ trợ loại tập tin "{types}".',msgInvalidFileExtension:'Phần mở rộng của tập tin "{name}" không hợp lệ. Chỉ hỗ trợ phần mở rộng "{extensions}".',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"Đã dừng tải lên",msgUploadThreshold:"Đang xử lý...",msgUploadBegin:"Đang khởi tạo...",msgUploadEnd:"Đã xong",msgUploadEmpty:"Không có dữ liệu hợp lệ để tải lên.",msgUploadError:"Lỗi",msgValidationError:"Lỗi xác nhận",msgLoading:"Đang nạp {index} tập tin trong số {files} &hellip;",msgProgress:"Đang nạp {index} tập tin trong số {files} - {name} - {percent}% hoàn thành.",msgSelected:"{n} {files} được chọn",msgFoldersNotAllowed:"Chỉ kéo thả tập tin! Đã bỏ qua {n} thư mục.",msgImageWidthSmall:'Chiều rộng của hình ảnh "{name}" phải tối thiểu là {size} px.',msgImageHeightSmall:'Chiều cao của hình ảnh "{name}" phải tối thiểu là {size} px.',msgImageWidthLarge:'Chiều rộng của hình ảnh "{name}" không được quá {size} px.',msgImageHeightLarge:'Chiều cao của hình ảnh "{name}" không được quá {size} px.',msgImageResizeError:"Không lấy được kích thước của hình ảnh để thay đổi kích cỡ.",msgImageResizeException:"Thay đổi kích cỡ hình ảnh bị lỗi.<pre>{errors}</pre>",msgAjaxError:"Đã xảy ra sự cố với thao tác {operation}. Vui lòng thử lại sau!",msgAjaxProgressError:"Lỗi {operation}",ajaxOperations:{deleteThumb:"Xóa tệp tin",uploadThumb:"Tải lên",uploadBatch:"Tả lên nhiều tệp",uploadExtra:"Mẫu dữ liệu tải lên"},dropZoneTitle:"Kéo thả tập tin vào đây &hellip;",dropZoneClickTitle:"<br>(hoặc click để chọn {files})",fileActionSettings:{removeTitle:"Gỡ bỏ",uploadTitle:"Tải lên",uploadRetryTitle:"Tải lên lại",downloadTitle:"Tải xuống",zoomTitle:"Phóng lớn",dragTitle:"Di chuyển / Sắp xếp lại",indicatorNewTitle:"Chưa được tải lên",indicatorSuccessTitle:"Đã tải lên",indicatorErrorTitle:"Tải lên bị lỗi",indicatorLoadingTitle:"Đang tải lên ..."},previewZoomButtonTitles:{prev:"Xem tập tin phía trước",next:"Xem tập tin tiếp theo",toggleheader:"Ẩn/hiện tiêu đề",fullscreen:"Bật/tắt toàn màn hình",borderless:"Bật/tắt chế độ không viền",close:"Đóng"}},e.fn.fileinputLocales.fr={fileSingle:"fichier",filePlural:"fichiers",browseLabel:"",captureLabel:"",fileURLLabel:"Url",removeLabel:"",removeTitle:"Retirer les fichiers sélectionnés",cancelLabel:"",cancelTitle:"Annuler l'envoi en cours",uploadLabel:"",uploadTitle:"Transférer les fichiers sélectionnés",msgNo:"Non",msgNoFilesSelected:"",msgCancelled:"Annulé",msgPlaceholder:"Sélectionner le(s) {files}...",msgZoomModalHeading:"Aperçu détaillé",msgFileRequired:"Vous devez sélectionner un fichier à uploader.",msgSizeTooSmall:'Le fichier "{name}" (<b>{size} KB</b>) est inférieur à la taille minimale de <b>{minSize} KB</b>.',msgSizeTooLarge:'Le fichier "{name}" (<b>{size} Ko</b>) dépasse la taille maximale autorisée qui est de <b>{maxSize} Ko</b>.',msgFilesTooLess:"Vous devez sélectionner au moins <b>{n}</b> {files} à transmettre.",msgFilesTooMany:"Le nombre de fichier sélectionné <b>({n})</b> dépasse la quantité maximale autorisée qui est de <b>{m}</b>.",msgFileNotFound:'Le fichier "{name}" est introuvable !',msgFileSecured:'Des restrictions de sécurité vous empêchent d\'accéder au fichier "{name}".',msgFileNotReadable:'Le fichier "{name}" est illisible.',msgFilePreviewAborted:'Prévisualisation du fichier "{name}" annulée.',msgFilePreviewError:'Une erreur est survenue lors de la lecture du fichier "{name}".',msgInvalidFileName:'Caractères invalides ou non supportés dans le nom de fichier "{name}".',msgInvalidFileType:'Type de document invalide pour "{name}". Seulement les documents de type "{types}" sont autorisés.',msgInvalidFileExtension:'Extension invalide pour le fichier "{name}". Seules les extensions "{extensions}" sont autorisées.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"Le transfert du fichier a été interrompu",msgUploadThreshold:"En cours...",msgUploadBegin:"Initialisation...",msgUploadEnd:"Terminé",msgUploadEmpty:"Aucune donnée valide disponible pour transmission.",msgUploadError:"Erreur",msgValidationError:"Erreur de validation",msgLoading:"Transmission du fichier {index} sur {files}&hellip;",msgProgress:"Transmission du fichier {index} sur {files} - {name} - {percent}%.",msgSelected:"{n} {files} sélectionné(s)",msgFoldersNotAllowed:"Glissez et déposez uniquement des fichiers ! {n} répertoire(s) exclu(s).",msgImageWidthSmall:"La largeur de l'image \"{name}\" doit être d'au moins {size} px.",msgImageHeightSmall:"La hauteur de l'image \"{name}\" doit être d'au moins {size} px.",msgImageWidthLarge:'La largeur de l\'image "{name}" ne peut pas dépasser {size} px.',msgImageHeightLarge:'La hauteur de l\'image "{name}" ne peut pas dépasser {size} px.',msgImageResizeError:"Impossible d'obtenir les dimensions de l'image à redimensionner.",msgImageResizeException:"Erreur lors du redimensionnement de l'image.<pre>{errors}</pre>",msgAjaxError:"Une erreur s'est produite pendant l'opération de {operation}. Veuillez réessayer plus tard.",msgAjaxProgressError:'L\'opération "{operation}" a échoué',ajaxOperations:{deleteThumb:"suppression du fichier",uploadThumb:"transfert du fichier",uploadBatch:"transfert des fichiers",uploadExtra:"soumission des données de formulaire"},dropZoneTitle:"Glissez et déposez les fichiers ici&hellip;",dropZoneClickTitle:"<br>(ou cliquez pour sélectionner manuellement)",fileActionSettings:{removeTitle:"Supprimer le fichier",uploadTitle:"Transférer le fichier",uploadRetryTitle:"Relancer le transfert",zoomTitle:"Voir les détails",dragTitle:"Déplacer / Réarranger",indicatorNewTitle:"Pas encore transféré",indicatorSuccessTitle:"Posté",indicatorErrorTitle:"Ajouter erreur",indicatorLoadingTitle:"En cours..."},previewZoomButtonTitles:{prev:"Voir le fichier précédent",next:"Voir le fichier suivant",toggleheader:"Masquer le titre",fullscreen:"Mode plein écran",borderless:"Mode cinéma",close:"Fermer l'aperçu"}},e.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",captureLabel:"Capt",fileURLLabel:"Link",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgPlaceholder:"Select {files}...",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgUploadBegin:"Initializing...",msgUploadEnd:"Done",msgUploadEmpty:"No valid data available for upload.",msgUploadError:"Error",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! Skipped {n} dropped folder(s).",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",fileActionSettings:{removeTitle:"Remove file",uploadTitle:"Upload file",uploadRetryTitle:"Retry upload",downloadTitle:"Download file",zoomTitle:"View details",dragTitle:"Move / Rearrange",indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."},previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"}},e.fn.fileinput.Constructor=i,e(F).ready((function(){var t=e("input.file[type=file]");t.length&&t.fileinput()})),"undefined"==typeof window||!window.document)return function(){throw new Error("KvSortable.js requires a window with a document")};var a,n,r,o,l,s,d,c,p,u,f,h,m,g,v,w,b,_,y,C,x,T={},E=/\s+/g,S=/left|right|inline/,k="KvSortable"+(new Date).getTime(),D=window,F=D.document,A=D.parseInt,P=D.setTimeout,I=(e=D.jQuery||D.Zepto,D.Polymer),z=!1,L="draggable"in F.createElement("div"),U=!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie)/i)&&((x=F.createElement("x")).style.cssText="pointer-events:auto","auto"===x.style.pointerEvents),$=!1,R=Math.abs,j=Math.min,B=[],O=[],M=re((function(e,t,i){if(i&&t.scroll){var a,n,r,o,l,s,d=i[k],f=t.scrollSensitivity,h=t.scrollSpeed,m=e.clientX,g=e.clientY,v=window.innerWidth,w=window.innerHeight;if(p!==i&&(c=t.scroll,p=i,u=t.scrollFn,!0===c)){c=i;do{if(c.offsetWidth<c.scrollWidth||c.offsetHeight<c.scrollHeight)break}while(c=c.parentNode)}c&&(a=c,n=c.getBoundingClientRect(),r=(R(n.right-m)<=f)-(R(n.left-m)<=f),o=(R(n.bottom-g)<=f)-(R(n.top-g)<=f)),r||o||(o=(w-g<=f)-(g<=f),((r=(v-m<=f)-(m<=f))||o)&&(a=D)),T.vx===r&&T.vy===o&&T.el===a||(T.el=a,T.vx=r,T.vy=o,clearInterval(T.pid),a&&(T.pid=setInterval((function(){if(s=o?o*h:0,l=r?r*h:0,"function"==typeof u)return u.call(d,l,s,e);a===D?D.scrollTo(D.pageXOffset+l,D.pageYOffset+s):(a.scrollTop+=s,a.scrollLeft+=l)}),24)))}}),30),N=function(e){function t(e,t){return void 0!==e&&!0!==e||(e=i.name),"function"==typeof e?e:function(i,a){var n=a.options.group.name;return t?e:e&&(e.join?e.indexOf(n)>-1:n==e)}}var i={},a=e.group;a&&"object"==typeof a||(a={name:a}),i.name=a.name,i.checkPull=t(a.pull,!0),i.checkPut=t(a.put),i.revertClone=a.revertClone,e.group=i};try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){z={capture:!1,passive:!1}}}))}catch(e){}function Z(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"KvSortable: `el` must be HTMLElement, and not "+{}.toString.call(e);this.el=e,this.options=t=oe({},t),e[k]=this;var i={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(e.nodeName)?"li":">*",ghostClass:"kvsortable-ghost",chosenClass:"kvsortable-chosen",dragClass:"kvsortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"kvsortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Z.supportPointer};for(var a in i)!(a in t)&&(t[a]=i[a]);for(var n in N(t),this)"_"===n.charAt(0)&&"function"==typeof this[n]&&(this[n]=this[n].bind(this));this.nativeDraggable=!t.forceFallback&&L,X(e,"mousedown",this._onTapStart),X(e,"touchstart",this._onTapStart),t.supportPointer&&X(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(X(e,"dragover",this),X(e,"dragenter",this)),O.push(this._onDragOver),t.store&&this.sort(t.store.get(this))}function H(e,t){"clone"!==e.lastPullMode&&(t=!0),o&&o.state!==t&&(K(o,"display",t?"none":""),t||o.state&&(e.options.group.revertClone?(l.insertBefore(o,s),e._animate(a,o)):l.insertBefore(o,a)),o.state=t)}function W(e,t,i){if(e){i=i||F;do{if(">*"===t&&e.parentNode===i||ne(e,t))return e}while(e=q(e))}return null}function q(e){var t=e.host;return t&&t.nodeType?t:e.parentNode}function X(e,t,i){e.addEventListener(t,i,z)}function Y(e,t,i){e.removeEventListener(t,i,z)}function V(e,t,i){if(e)if(e.classList)e.classList[i?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(E," ").replace(" "+t+" "," ");e.className=(a+(i?" "+t:"")).replace(E," ")}}function K(e,t,i){var a=e&&e.style;if(a){if(void 0===i)return F.defaultView&&F.defaultView.getComputedStyle?i=F.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in a||(t="-webkit-"+t),a[t]=i+("string"==typeof i?"":"px")}}function G(e,t,i){if(e){var a=e.getElementsByTagName(t),n=0,r=a.length;if(i)for(;n<r;n++)i(a[n],n);return a}return[]}function J(e,t,i,a,n,r,l,s){e=e||t[k];var d=F.createEvent("Event"),c=e.options,p="on"+i.charAt(0).toUpperCase()+i.substr(1);d.initEvent(i,!0,!0),d.to=n||t,d.from=r||t,d.item=a||t,d.clone=o,d.oldIndex=l,d.newIndex=s,t.dispatchEvent(d),c[p]&&c[p].call(e,d)}function Q(e,t,i,a,n,r,o,l){var s,d,c=e[k],p=c.options.onMove;return(s=F.createEvent("Event")).initEvent("move",!0,!0),s.to=t,s.from=e,s.dragged=i,s.draggedRect=a,s.related=n||t,s.relatedRect=r||t.getBoundingClientRect(),s.willInsertAfter=l,e.dispatchEvent(s),p&&(d=p.call(c,s,o)),d}function ee(e){e.draggable=!1}function te(){$=!1}function ie(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,a=0;i--;)a+=t.charCodeAt(i);return a.toString(36)}function ae(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e&&(e=e.previousElementSibling);)"TEMPLATE"===e.nodeName.toUpperCase()||">*"!==t&&!ne(e,t)||i++;return i}function ne(e,t){if(e){var i=(t=t.split(".")).shift().toUpperCase(),a=new RegExp("\\s("+t.join("|")+")(?=\\s)","g");return!(""!==i&&e.nodeName.toUpperCase()!=i||t.length&&((" "+e.className+" ").match(a)||[]).length!=t.length)}return!1}function re(e,t){var i,a;return function(){void 0===i&&(i=arguments,a=this,P((function(){1===i.length?e.call(a,i[0]):e.apply(a,i),i=void 0}),t))}}function oe(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function le(t){return I&&I.dom?I.dom(t).cloneNode(!0):e?e(t).clone(!0)[0]:t.cloneNode(!0)}function se(e){return P(e,0)}function de(e){return clearTimeout(e)}Z.prototype={constructor:Z,_onTapStart:function(e){var t,i=this,n=this.el,r=this.options,o=r.preventOnFilter,l=e.type,s=e.touches&&e.touches[0],c=(s||e).target,p=e.target.shadowRoot&&e.path&&e.path[0]||c,u=r.filter;if(function(e){var t=e.getElementsByTagName("input"),i=t.length;for(;i--;){var a=t[i];a.checked&&B.push(a)}}(n),!a&&!(/mousedown|pointerdown/.test(l)&&0!==e.button||r.disabled)&&!p.isContentEditable&&(c=W(c,r.draggable,n))&&d!==c){if(t=ae(c,r.draggable),"function"==typeof u){if(u.call(this,e,c,this))return J(i,p,"filter",c,n,n,t),void(o&&e.preventDefault())}else if(u&&(u=u.split(",").some((function(e){if(e=W(p,e.trim(),n))return J(i,e,"filter",c,n,n,t),!0}))))return void(o&&e.preventDefault());r.handle&&!W(p,r.handle,n)||this._prepareDragStart(e,s,c,t)}},_prepareDragStart:function(e,t,i,r){var o,c=this,p=c.el,u=c.options,f=p.ownerDocument;i&&!a&&i.parentNode===p&&(_=e,l=p,n=(a=i).parentNode,s=a.nextSibling,d=i,w=u.group,g=r,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,a.style["will-change"]="all",o=function(){c._disableDelayedDrag(),a.draggable=c.nativeDraggable,V(a,u.chosenClass,!0),c._triggerDragStart(e,t),J(c,l,"choose",a,l,l,g)},u.ignore.split(",").forEach((function(e){G(a,e.trim(),ee)})),X(f,"mouseup",c._onDrop),X(f,"touchend",c._onDrop),X(f,"touchcancel",c._onDrop),X(f,"selectstart",c),u.supportPointer&&X(f,"pointercancel",c._onDrop),u.delay?(X(f,"mouseup",c._disableDelayedDrag),X(f,"touchend",c._disableDelayedDrag),X(f,"touchcancel",c._disableDelayedDrag),X(f,"mousemove",c._disableDelayedDrag),X(f,"touchmove",c._disableDelayedDrag),u.supportPointer&&X(f,"pointermove",c._disableDelayedDrag),c._dragStartTimer=P(o,u.delay)):o())},_disableDelayedDrag:function(){var e=this.el.ownerDocument;clearTimeout(this._dragStartTimer),Y(e,"mouseup",this._disableDelayedDrag),Y(e,"touchend",this._disableDelayedDrag),Y(e,"touchcancel",this._disableDelayedDrag),Y(e,"mousemove",this._disableDelayedDrag),Y(e,"touchmove",this._disableDelayedDrag),Y(e,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(e,t){(t=t||("touch"==e.pointerType?e:null))?(_={target:a,clientX:t.clientX,clientY:t.clientY},this._onDragStart(_,"touch")):this.nativeDraggable?(X(a,"dragend",this),X(l,"dragstart",this._onDragStart)):this._onDragStart(_,!0);try{F.selection?se((function(){F.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(){if(l&&a){var e=this.options;V(a,e.ghostClass,!0),V(a,e.dragClass,!1),Z.active=this,J(this,l,"start",a,l,l,g)}else this._nulling()},_emulateDragOver:function(){if(y){if(this._lastX===y.clientX&&this._lastY===y.clientY)return;this._lastX=y.clientX,this._lastY=y.clientY,U||K(r,"display","none");var e=F.elementFromPoint(y.clientX,y.clientY),t=e,i=O.length;if(e&&e.shadowRoot&&(t=e=e.shadowRoot.elementFromPoint(y.clientX,y.clientY)),t)do{if(t[k]){for(;i--;)O[i]({clientX:y.clientX,clientY:y.clientY,target:e,rootEl:t});break}e=t}while(t=t.parentNode);U||K(r,"display","")}},_onTouchMove:function(e){if(_){var t=this.options,i=t.fallbackTolerance,a=t.fallbackOffset,n=e.touches?e.touches[0]:e,o=n.clientX-_.clientX+a.x,l=n.clientY-_.clientY+a.y,s=e.touches?"translate3d("+o+"px,"+l+"px,0)":"translate("+o+"px,"+l+"px)";if(!Z.active){if(i&&j(R(n.clientX-this._lastX),R(n.clientY-this._lastY))<i)return;this._dragStarted()}this._appendGhost(),C=!0,y=n,K(r,"webkitTransform",s),K(r,"mozTransform",s),K(r,"msTransform",s),K(r,"transform",s),e.preventDefault()}},_appendGhost:function(){if(!r){var e,t=a.getBoundingClientRect(),i=K(a),n=this.options;V(r=a.cloneNode(!0),n.ghostClass,!1),V(r,n.fallbackClass,!0),V(r,n.dragClass,!0),K(r,"top",t.top-A(i.marginTop,10)),K(r,"left",t.left-A(i.marginLeft,10)),K(r,"width",t.width),K(r,"height",t.height),K(r,"opacity","0.8"),K(r,"position","fixed"),K(r,"zIndex","100000"),K(r,"pointerEvents","none"),n.fallbackOnBody&&F.body.appendChild(r)||l.appendChild(r),e=r.getBoundingClientRect(),K(r,"width",2*t.width-e.width),K(r,"height",2*t.height-e.height)}},_onDragStart:function(e,t){var i=this,n=e.dataTransfer,r=i.options;i._offUpEvents(),w.checkPull(i,i,a,e)&&((o=le(a)).draggable=!1,o.style["will-change"]="",K(o,"display","none"),V(o,i.options.chosenClass,!1),i._cloneId=se((function(){l.insertBefore(o,a),J(i,l,"clone",a)}))),V(a,r.dragClass,!0),t?("touch"===t?(X(F,"touchmove",i._onTouchMove),X(F,"touchend",i._onDrop),X(F,"touchcancel",i._onDrop),r.supportPointer&&(X(F,"pointermove",i._onTouchMove),X(F,"pointerup",i._onDrop))):(X(F,"mousemove",i._onTouchMove),X(F,"mouseup",i._onDrop)),i._loopId=setInterval(i._emulateDragOver,50)):(n&&(n.effectAllowed="move",r.setData&&r.setData.call(i,n,a)),X(F,"drop",i),i._dragStartId=se(i._dragStarted))},_onDragOver:function(e){var t,i,d,c,p=this.el,u=this.options,g=u.group,v=Z.active,_=w===g,y=!1,x=u.sort;if(void 0!==e.preventDefault&&(e.preventDefault(),!u.dragoverBubble&&e.stopPropagation()),!a.animated&&(C=!0,v&&!u.disabled&&(_?x||(c=!l.contains(a)):b===this||(v.lastPullMode=w.checkPull(this,v,a,e))&&g.checkPut(this,v,a,e))&&(void 0===e.rootEl||e.rootEl===this.el))){if(M(e,u,this.el),$)return;if(t=W(e.target,u.draggable,p),i=a.getBoundingClientRect(),b!==this&&(b=this,y=!0),c)return H(v,!0),n=l,void(o||s?l.insertBefore(a,o||s):x||l.appendChild(a));if(0===p.children.length||p.children[0]===r||p===e.target&&function(e,t){var i=e.lastElementChild,a=i.getBoundingClientRect();return t.clientY-(a.top+a.height)>5||t.clientX-(a.left+a.width)>5}(p,e)){if(0!==p.children.length&&p.children[0]!==r&&p===e.target&&(t=p.lastElementChild),t){if(t.animated)return;d=t.getBoundingClientRect()}H(v,_),!1!==Q(l,p,a,i,t,d,e)&&(a.contains(p)||(p.appendChild(a),n=p),this._animate(i,a),t&&this._animate(d,t))}else if(t&&!t.animated&&t!==a&&void 0!==t.parentNode[k]){f!==t&&(f=t,h=K(t),m=K(t.parentNode));var T=(d=t.getBoundingClientRect()).right-d.left,E=d.bottom-d.top,D=S.test(h.cssFloat+h.display)||"flex"==m.display&&0===m["flex-direction"].indexOf("row"),F=t.offsetWidth>a.offsetWidth,A=t.offsetHeight>a.offsetHeight,I=(D?(e.clientX-d.left)/T:(e.clientY-d.top)/E)>.5,z=t.nextElementSibling,L=!1;if(D){var U=a.offsetTop,R=t.offsetTop;L=U===R?t.previousElementSibling===a&&!F||I&&F:t.previousElementSibling===a||a.previousElementSibling===t?(e.clientY-d.top)/E>.5:R>U}else y||(L=z!==a&&!A||I&&A);var j=Q(l,p,a,i,t,d,e,L);!1!==j&&(1!==j&&-1!==j||(L=1===j),$=!0,P(te,30),H(v,_),a.contains(p)||(L&&!z?p.appendChild(a):t.parentNode.insertBefore(a,L?z:t)),n=a.parentNode,this._animate(i,a),this._animate(d,t))}}},_animate:function(e,t){var i=this.options.animation;if(i){var a=t.getBoundingClientRect();1===e.nodeType&&(e=e.getBoundingClientRect()),K(t,"transition","none"),K(t,"transform","translate3d("+(e.left-a.left)+"px,"+(e.top-a.top)+"px,0)"),t.offsetWidth,K(t,"transition","all "+i+"ms"),K(t,"transform","translate3d(0,0,0)"),clearTimeout(t.animated),t.animated=P((function(){K(t,"transition",""),K(t,"transform",""),t.animated=!1}),i)}},_offUpEvents:function(){var e=this.el.ownerDocument;Y(F,"touchmove",this._onTouchMove),Y(F,"pointermove",this._onTouchMove),Y(e,"mouseup",this._onDrop),Y(e,"touchend",this._onDrop),Y(e,"pointerup",this._onDrop),Y(e,"touchcancel",this._onDrop),Y(e,"pointercancel",this._onDrop),Y(e,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;clearInterval(this._loopId),clearInterval(T.pid),clearTimeout(this._dragStartTimer),de(this._cloneId),de(this._dragStartId),Y(F,"mouseover",this),Y(F,"mousemove",this._onTouchMove),this.nativeDraggable&&(Y(F,"drop",this),Y(t,"dragstart",this._onDragStart)),this._offUpEvents(),e&&(C&&(e.preventDefault(),!i.dropBubble&&e.stopPropagation()),r&&r.parentNode&&r.parentNode.removeChild(r),l!==n&&"clone"===Z.active.lastPullMode||o&&o.parentNode&&o.parentNode.removeChild(o),a&&(this.nativeDraggable&&Y(a,"dragend",this),ee(a),a.style["will-change"]="",V(a,this.options.ghostClass,!1),V(a,this.options.chosenClass,!1),J(this,l,"unchoose",a,n,l,g),l!==n?(v=ae(a,i.draggable))>=0&&(J(null,n,"add",a,n,l,g,v),J(this,l,"remove",a,n,l,g,v),J(null,n,"sort",a,n,l,g,v),J(this,l,"sort",a,n,l,g,v)):a.nextSibling!==s&&(v=ae(a,i.draggable))>=0&&(J(this,l,"update",a,n,l,g,v),J(this,l,"sort",a,n,l,g,v)),Z.active&&(null!=v&&-1!==v||(v=g),J(this,l,"end",a,n,l,g,v),this.save()))),this._nulling()},_nulling:function(){l=a=n=r=s=o=d=c=p=_=y=C=v=f=h=b=w=Z.active=null,B.forEach((function(e){e.checked=!0})),B.length=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":case"mouseover":this._onDrop(e);break;case"dragover":case"dragenter":a&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],i=this.el.children,a=0,n=i.length,r=this.options;a<n;a++)W(e=i[a],r.draggable,this.el)&&t.push(e.getAttribute(r.dataIdAttr)||ie(e));return t},sort:function(e){var t={},i=this.el;this.toArray().forEach((function(e,a){var n=i.children[a];W(n,this.options.draggable,i)&&(t[e]=n)}),this),e.forEach((function(e){t[e]&&(i.removeChild(t[e]),i.appendChild(t[e]))}))},save:function(){var e=this.options.store;e&&e.set(this)},closest:function(e,t){return W(e,t||this.options.draggable,this.el)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];i[e]=t,"group"===e&&N(i)},destroy:function(){var e=this.el;e[k]=null,Y(e,"mousedown",this._onTapStart),Y(e,"touchstart",this._onTapStart),Y(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Y(e,"dragover",this),Y(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),O.splice(O.indexOf(this._onDragOver),1),this._onDrop(),this.el=e=null}},X(F,"touchmove",(function(e){Z.active&&e.preventDefault()})),Z.utils={on:X,off:Y,css:K,find:G,is:function(e,t){return!!W(e,t,e)},extend:oe,throttle:re,closest:W,toggleClass:V,clone:le,index:ae,nextTick:se,cancelNextTick:de},Z.create=function(e,t){return new Z(e,t)},Z.version="1.7.0"})),function(e){"use strict";"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&void 0!==module.exports?module.exports=e():window.KvSortable=e()}((function(){"use strict";if("undefined"==typeof window||!window.document)return function(){throw new Error("KvSortable.js requires a window with a document")};var e,t,i,a,n,r,o,l,s,d,c,p,u,f,h,m,g,v,w,b,_,y={},C=/\s+/g,x=/left|right|inline/,T="KvSortable"+(new Date).getTime(),E=window,S=E.document,k=E.parseInt,D=E.setTimeout,F=E.jQuery||E.Zepto,A=E.Polymer,P=!1,I="draggable"in S.createElement("div"),z=!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie)/i)&&((_=S.createElement("x")).style.cssText="pointer-events:auto","auto"===_.style.pointerEvents),L=!1,U=Math.abs,$=Math.min,R=[],j=[],B=ae((function(e,t,i){if(i&&t.scroll){var a,n,r,o,c,p,u=i[T],f=t.scrollSensitivity,h=t.scrollSpeed,m=e.clientX,g=e.clientY,v=window.innerWidth,w=window.innerHeight;if(s!==i&&(l=t.scroll,s=i,d=t.scrollFn,!0===l)){l=i;do{if(l.offsetWidth<l.scrollWidth||l.offsetHeight<l.scrollHeight)break}while(l=l.parentNode)}l&&(a=l,n=l.getBoundingClientRect(),r=(U(n.right-m)<=f)-(U(n.left-m)<=f),o=(U(n.bottom-g)<=f)-(U(n.top-g)<=f)),r||o||(o=(w-g<=f)-(g<=f),((r=(v-m<=f)-(m<=f))||o)&&(a=E)),y.vx===r&&y.vy===o&&y.el===a||(y.el=a,y.vx=r,y.vy=o,clearInterval(y.pid),a&&(y.pid=setInterval((function(){if(p=o?o*h:0,c=r?r*h:0,"function"==typeof d)return d.call(u,c,p,e);a===E?E.scrollTo(E.pageXOffset+c,E.pageYOffset+p):(a.scrollTop+=p,a.scrollLeft+=c)}),24)))}}),30),O=function(e){function t(e,t){return void 0!==e&&!0!==e||(e=i.name),"function"==typeof e?e:function(i,a){var n=a.options.group.name;return t?e:e&&(e.join?e.indexOf(n)>-1:n==e)}}var i={},a=e.group;a&&"object"==typeof a||(a={name:a}),i.name=a.name,i.checkPull=t(a.pull,!0),i.checkPut=t(a.put),i.revertClone=a.revertClone,e.group=i};try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){P={capture:!1,passive:!1}}}))}catch(e){}function M(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"KvSortable: `el` must be HTMLElement, and not "+{}.toString.call(e);this.el=e,this.options=t=ne({},t),e[T]=this;var i={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(e.nodeName)?"li":">*",ghostClass:"kvsortable-ghost",chosenClass:"kvsortable-chosen",dragClass:"kvsortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"kvsortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==M.supportPointer};for(var a in i)!(a in t)&&(t[a]=i[a]);for(var n in O(t),this)"_"===n.charAt(0)&&"function"==typeof this[n]&&(this[n]=this[n].bind(this));this.nativeDraggable=!t.forceFallback&&I,W(e,"mousedown",this._onTapStart),W(e,"touchstart",this._onTapStart),t.supportPointer&&W(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(W(e,"dragover",this),W(e,"dragenter",this)),j.push(this._onDragOver),t.store&&this.sort(t.store.get(this))}function N(t,i){"clone"!==t.lastPullMode&&(i=!0),a&&a.state!==i&&(Y(a,"display",i?"none":""),i||a.state&&(t.options.group.revertClone?(n.insertBefore(a,r),t._animate(e,a)):n.insertBefore(a,e)),a.state=i)}function Z(e,t,i){if(e){i=i||S;do{if(">*"===t&&e.parentNode===i||ie(e,t))return e}while(e=H(e))}return null}function H(e){var t=e.host;return t&&t.nodeType?t:e.parentNode}function W(e,t,i){e.addEventListener(t,i,P)}function q(e,t,i){e.removeEventListener(t,i,P)}function X(e,t,i){if(e)if(e.classList)e.classList[i?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(C," ").replace(" "+t+" "," ");e.className=(a+(i?" "+t:"")).replace(C," ")}}function Y(e,t,i){var a=e&&e.style;if(a){if(void 0===i)return S.defaultView&&S.defaultView.getComputedStyle?i=S.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in a||(t="-webkit-"+t),a[t]=i+("string"==typeof i?"":"px")}}function V(e,t,i){if(e){var a=e.getElementsByTagName(t),n=0,r=a.length;if(i)for(;n<r;n++)i(a[n],n);return a}return[]}function K(e,t,i,n,r,o,l,s){e=e||t[T];var d=S.createEvent("Event"),c=e.options,p="on"+i.charAt(0).toUpperCase()+i.substr(1);d.initEvent(i,!0,!0),d.to=r||t,d.from=o||t,d.item=n||t,d.clone=a,d.oldIndex=l,d.newIndex=s,t.dispatchEvent(d),c[p]&&c[p].call(e,d)}function G(e,t,i,a,n,r,o,l){var s,d,c=e[T],p=c.options.onMove;return(s=S.createEvent("Event")).initEvent("move",!0,!0),s.to=t,s.from=e,s.dragged=i,s.draggedRect=a,s.related=n||t,s.relatedRect=r||t.getBoundingClientRect(),s.willInsertAfter=l,e.dispatchEvent(s),p&&(d=p.call(c,s,o)),d}function J(e){e.draggable=!1}function Q(){L=!1}function ee(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,a=0;i--;)a+=t.charCodeAt(i);return a.toString(36)}function te(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e&&(e=e.previousElementSibling);)"TEMPLATE"===e.nodeName.toUpperCase()||">*"!==t&&!ie(e,t)||i++;return i}function ie(e,t){if(e){var i=(t=t.split(".")).shift().toUpperCase(),a=new RegExp("\\s("+t.join("|")+")(?=\\s)","g");return!(""!==i&&e.nodeName.toUpperCase()!=i||t.length&&((" "+e.className+" ").match(a)||[]).length!=t.length)}return!1}function ae(e,t){var i,a;return function(){void 0===i&&(i=arguments,a=this,D((function(){1===i.length?e.call(a,i[0]):e.apply(a,i),i=void 0}),t))}}function ne(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function re(e){return A&&A.dom?A.dom(e).cloneNode(!0):F?F(e).clone(!0)[0]:e.cloneNode(!0)}function oe(e){return D(e,0)}function le(e){return clearTimeout(e)}M.prototype={constructor:M,_onTapStart:function(t){var i,a=this,n=this.el,r=this.options,l=r.preventOnFilter,s=t.type,d=t.touches&&t.touches[0],c=(d||t).target,p=t.target.shadowRoot&&t.path&&t.path[0]||c,u=r.filter;if(function(e){var t=e.getElementsByTagName("input"),i=t.length;for(;i--;){var a=t[i];a.checked&&R.push(a)}}(n),!e&&!(/mousedown|pointerdown/.test(s)&&0!==t.button||r.disabled)&&!p.isContentEditable&&(c=Z(c,r.draggable,n))&&o!==c){if(i=te(c,r.draggable),"function"==typeof u){if(u.call(this,t,c,this))return K(a,p,"filter",c,n,n,i),void(l&&t.preventDefault())}else if(u&&(u=u.split(",").some((function(e){if(e=Z(p,e.trim(),n))return K(a,e,"filter",c,n,n,i),!0}))))return void(l&&t.preventDefault());r.handle&&!Z(p,r.handle,n)||this._prepareDragStart(t,d,c,i)}},_prepareDragStart:function(i,a,l,s){var d,c=this,p=c.el,u=c.options,h=p.ownerDocument;l&&!e&&l.parentNode===p&&(v=i,n=p,t=(e=l).parentNode,r=e.nextSibling,o=l,m=u.group,f=s,this._lastX=(a||i).clientX,this._lastY=(a||i).clientY,e.style["will-change"]="all",d=function(){c._disableDelayedDrag(),e.draggable=c.nativeDraggable,X(e,u.chosenClass,!0),c._triggerDragStart(i,a),K(c,n,"choose",e,n,n,f)},u.ignore.split(",").forEach((function(t){V(e,t.trim(),J)})),W(h,"mouseup",c._onDrop),W(h,"touchend",c._onDrop),W(h,"touchcancel",c._onDrop),W(h,"selectstart",c),u.supportPointer&&W(h,"pointercancel",c._onDrop),u.delay?(W(h,"mouseup",c._disableDelayedDrag),W(h,"touchend",c._disableDelayedDrag),W(h,"touchcancel",c._disableDelayedDrag),W(h,"mousemove",c._disableDelayedDrag),W(h,"touchmove",c._disableDelayedDrag),u.supportPointer&&W(h,"pointermove",c._disableDelayedDrag),c._dragStartTimer=D(d,u.delay)):d())},_disableDelayedDrag:function(){var e=this.el.ownerDocument;clearTimeout(this._dragStartTimer),q(e,"mouseup",this._disableDelayedDrag),q(e,"touchend",this._disableDelayedDrag),q(e,"touchcancel",this._disableDelayedDrag),q(e,"mousemove",this._disableDelayedDrag),q(e,"touchmove",this._disableDelayedDrag),q(e,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(t,i){(i=i||("touch"==t.pointerType?t:null))?(v={target:e,clientX:i.clientX,clientY:i.clientY},this._onDragStart(v,"touch")):this.nativeDraggable?(W(e,"dragend",this),W(n,"dragstart",this._onDragStart)):this._onDragStart(v,!0);try{S.selection?oe((function(){S.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(){if(n&&e){var t=this.options;X(e,t.ghostClass,!0),X(e,t.dragClass,!1),M.active=this,K(this,n,"start",e,n,n,f)}else this._nulling()},_emulateDragOver:function(){if(w){if(this._lastX===w.clientX&&this._lastY===w.clientY)return;this._lastX=w.clientX,this._lastY=w.clientY,z||Y(i,"display","none");var e=S.elementFromPoint(w.clientX,w.clientY),t=e,a=j.length;if(e&&e.shadowRoot&&(t=e=e.shadowRoot.elementFromPoint(w.clientX,w.clientY)),t)do{if(t[T]){for(;a--;)j[a]({clientX:w.clientX,clientY:w.clientY,target:e,rootEl:t});break}e=t}while(t=t.parentNode);z||Y(i,"display","")}},_onTouchMove:function(e){if(v){var t=this.options,a=t.fallbackTolerance,n=t.fallbackOffset,r=e.touches?e.touches[0]:e,o=r.clientX-v.clientX+n.x,l=r.clientY-v.clientY+n.y,s=e.touches?"translate3d("+o+"px,"+l+"px,0)":"translate("+o+"px,"+l+"px)";if(!M.active){if(a&&$(U(r.clientX-this._lastX),U(r.clientY-this._lastY))<a)return;this._dragStarted()}this._appendGhost(),b=!0,w=r,Y(i,"webkitTransform",s),Y(i,"mozTransform",s),Y(i,"msTransform",s),Y(i,"transform",s),e.preventDefault()}},_appendGhost:function(){if(!i){var t,a=e.getBoundingClientRect(),r=Y(e),o=this.options;X(i=e.cloneNode(!0),o.ghostClass,!1),X(i,o.fallbackClass,!0),X(i,o.dragClass,!0),Y(i,"top",a.top-k(r.marginTop,10)),Y(i,"left",a.left-k(r.marginLeft,10)),Y(i,"width",a.width),Y(i,"height",a.height),Y(i,"opacity","0.8"),Y(i,"position","fixed"),Y(i,"zIndex","100000"),Y(i,"pointerEvents","none"),o.fallbackOnBody&&S.body.appendChild(i)||n.appendChild(i),t=i.getBoundingClientRect(),Y(i,"width",2*a.width-t.width),Y(i,"height",2*a.height-t.height)}},_onDragStart:function(t,i){var r=this,o=t.dataTransfer,l=r.options;r._offUpEvents(),m.checkPull(r,r,e,t)&&((a=re(e)).draggable=!1,a.style["will-change"]="",Y(a,"display","none"),X(a,r.options.chosenClass,!1),r._cloneId=oe((function(){n.insertBefore(a,e),K(r,n,"clone",e)}))),X(e,l.dragClass,!0),i?("touch"===i?(W(S,"touchmove",r._onTouchMove),W(S,"touchend",r._onDrop),W(S,"touchcancel",r._onDrop),l.supportPointer&&(W(S,"pointermove",r._onTouchMove),W(S,"pointerup",r._onDrop))):(W(S,"mousemove",r._onTouchMove),W(S,"mouseup",r._onDrop)),r._loopId=setInterval(r._emulateDragOver,50)):(o&&(o.effectAllowed="move",l.setData&&l.setData.call(r,o,e)),W(S,"drop",r),r._dragStartId=oe(r._dragStarted))},_onDragOver:function(o){var l,s,d,f,h=this.el,v=this.options,w=v.group,_=M.active,y=m===w,C=!1,E=v.sort;if(void 0!==o.preventDefault&&(o.preventDefault(),!v.dragoverBubble&&o.stopPropagation()),!e.animated&&(b=!0,_&&!v.disabled&&(y?E||(f=!n.contains(e)):g===this||(_.lastPullMode=m.checkPull(this,_,e,o))&&w.checkPut(this,_,e,o))&&(void 0===o.rootEl||o.rootEl===this.el))){if(B(o,v,this.el),L)return;if(l=Z(o.target,v.draggable,h),s=e.getBoundingClientRect(),g!==this&&(g=this,C=!0),f)return N(_,!0),t=n,void(a||r?n.insertBefore(e,a||r):E||n.appendChild(e));if(0===h.children.length||h.children[0]===i||h===o.target&&function(e,t){var i=e.lastElementChild,a=i.getBoundingClientRect();return t.clientY-(a.top+a.height)>5||t.clientX-(a.left+a.width)>5}(h,o)){if(0!==h.children.length&&h.children[0]!==i&&h===o.target&&(l=h.lastElementChild),l){if(l.animated)return;d=l.getBoundingClientRect()}N(_,y),!1!==G(n,h,e,s,l,d,o)&&(e.contains(h)||(h.appendChild(e),t=h),this._animate(s,e),l&&this._animate(d,l))}else if(l&&!l.animated&&l!==e&&void 0!==l.parentNode[T]){c!==l&&(c=l,p=Y(l),u=Y(l.parentNode));var S=(d=l.getBoundingClientRect()).right-d.left,k=d.bottom-d.top,F=x.test(p.cssFloat+p.display)||"flex"==u.display&&0===u["flex-direction"].indexOf("row"),A=l.offsetWidth>e.offsetWidth,P=l.offsetHeight>e.offsetHeight,I=(F?(o.clientX-d.left)/S:(o.clientY-d.top)/k)>.5,z=l.nextElementSibling,U=!1;if(F){var $=e.offsetTop,R=l.offsetTop;U=$===R?l.previousElementSibling===e&&!A||I&&A:l.previousElementSibling===e||e.previousElementSibling===l?(o.clientY-d.top)/k>.5:R>$}else C||(U=z!==e&&!P||I&&P);var j=G(n,h,e,s,l,d,o,U);!1!==j&&(1!==j&&-1!==j||(U=1===j),L=!0,D(Q,30),N(_,y),e.contains(h)||(U&&!z?h.appendChild(e):l.parentNode.insertBefore(e,U?z:l)),t=e.parentNode,this._animate(s,e),this._animate(d,l))}}},_animate:function(e,t){var i=this.options.animation;if(i){var a=t.getBoundingClientRect();1===e.nodeType&&(e=e.getBoundingClientRect()),Y(t,"transition","none"),Y(t,"transform","translate3d("+(e.left-a.left)+"px,"+(e.top-a.top)+"px,0)"),t.offsetWidth,Y(t,"transition","all "+i+"ms"),Y(t,"transform","translate3d(0,0,0)"),clearTimeout(t.animated),t.animated=D((function(){Y(t,"transition",""),Y(t,"transform",""),t.animated=!1}),i)}},_offUpEvents:function(){var e=this.el.ownerDocument;q(S,"touchmove",this._onTouchMove),q(S,"pointermove",this._onTouchMove),q(e,"mouseup",this._onDrop),q(e,"touchend",this._onDrop),q(e,"pointerup",this._onDrop),q(e,"touchcancel",this._onDrop),q(e,"pointercancel",this._onDrop),q(e,"selectstart",this)},_onDrop:function(o){var l=this.el,s=this.options;clearInterval(this._loopId),clearInterval(y.pid),clearTimeout(this._dragStartTimer),le(this._cloneId),le(this._dragStartId),q(S,"mouseover",this),q(S,"mousemove",this._onTouchMove),this.nativeDraggable&&(q(S,"drop",this),q(l,"dragstart",this._onDragStart)),this._offUpEvents(),o&&(b&&(o.preventDefault(),!s.dropBubble&&o.stopPropagation()),i&&i.parentNode&&i.parentNode.removeChild(i),n!==t&&"clone"===M.active.lastPullMode||a&&a.parentNode&&a.parentNode.removeChild(a),e&&(this.nativeDraggable&&q(e,"dragend",this),J(e),e.style["will-change"]="",X(e,this.options.ghostClass,!1),X(e,this.options.chosenClass,!1),K(this,n,"unchoose",e,t,n,f),n!==t?(h=te(e,s.draggable))>=0&&(K(null,t,"add",e,t,n,f,h),K(this,n,"remove",e,t,n,f,h),K(null,t,"sort",e,t,n,f,h),K(this,n,"sort",e,t,n,f,h)):e.nextSibling!==r&&(h=te(e,s.draggable))>=0&&(K(this,n,"update",e,t,n,f,h),K(this,n,"sort",e,t,n,f,h)),M.active&&(null!=h&&-1!==h||(h=f),K(this,n,"end",e,t,n,f,h),this.save()))),this._nulling()},_nulling:function(){n=e=t=i=r=a=o=l=s=v=w=b=h=c=p=g=m=M.active=null,R.forEach((function(e){e.checked=!0})),R.length=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":case"mouseover":this._onDrop(t);break;case"dragover":case"dragenter":e&&(this._onDragOver(t),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var e,t=[],i=this.el.children,a=0,n=i.length,r=this.options;a<n;a++)Z(e=i[a],r.draggable,this.el)&&t.push(e.getAttribute(r.dataIdAttr)||ee(e));return t},sort:function(e){var t={},i=this.el;this.toArray().forEach((function(e,a){var n=i.children[a];Z(n,this.options.draggable,i)&&(t[e]=n)}),this),e.forEach((function(e){t[e]&&(i.removeChild(t[e]),i.appendChild(t[e]))}))},save:function(){var e=this.options.store;e&&e.set(this)},closest:function(e,t){return Z(e,t||this.options.draggable,this.el)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];i[e]=t,"group"===e&&O(i)},destroy:function(){var e=this.el;e[T]=null,q(e,"mousedown",this._onTapStart),q(e,"touchstart",this._onTapStart),q(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(q(e,"dragover",this),q(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),j.splice(j.indexOf(this._onDragOver),1),this._onDrop(),this.el=e=null}},W(S,"touchmove",(function(e){M.active&&e.preventDefault()})),M.utils={on:W,off:q,css:Y,find:V,is:function(e,t){return!!Z(e,t,e)},extend:ne,throttle:ae,closest:Z,toggleClass:X,clone:re,index:te,nextTick:oe,cancelNextTick:le},M.create=function(e,t){return new M(e,t)},M.version="1.7.0",F.fn.kvsortable=function(e){var t,i=arguments;return this.each((function(){var a=F(this),n=a.data("kvsortable");n||!(e instanceof Object)&&e||(n=new M(this,e),a.data("kvsortable",n)),n&&("widget"===e?t=n:"destroy"===e?(n.destroy(),a.removeData("kvsortable")):"function"==typeof n[e]?t=n[e].apply(n,[].slice.call(i,1)):e in n.options&&(t=n.option.apply(n,i)))})),void 0===t?this:t};var se=function(e){return factory(e)};if(se.version="0.7.4",!window||!window.document||9!==window.document.nodeType)return se.isSupported=!1,se;var de=S=window.document,ce=window.DocumentFragment,pe=window.HTMLTemplateElement,ue=window.NodeFilter,fe=window.NamedNodeMap||window.MozNamedAttrMap,he=window.Text,me=window.Comment,ge=window.DOMParser;if("function"==typeof pe){var ve=S.createElement("template");ve.content&&ve.content.ownerDocument&&(S=ve.content.ownerDocument)}var we=S.implementation,be=S.createNodeIterator,_e=S.getElementsByTagName,ye=S.createDocumentFragment,Ce=de.importNode,xe={};se.isSupported=void 0!==we.createHTMLDocument&&9!==S.documentMode;var Te=function(e,t){for(var i=t.length;i--;)"string"==typeof t[i]&&(t[i]=t[i].toLowerCase()),e[t[i]]=!0;return e},Ee=function(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i},Se=null,ke=Te({},["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","#text"]),De=null,Fe=Te({},["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns","accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mode","min","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","surfacescale","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","y","y1","y2","z","zoomandpan","accent","accentunder","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","display","displaystyle","fence","frame","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ae=null,Pe=null,Ie=!0,ze=!1,Le=!1,Ue=!1,$e=/\{\{[\s\S]*|[\s\S]*\}\}/gm,Re=/<%[\s\S]*|[\s\S]*%>/gm,je=!1,Be=!1,Oe=!1,Me=!1,Ne=!0,Ze=!0,He=Te({},["audio","head","math","script","style","svg","video"]),We=Te({},["audio","video","img","source"]),qe=Te({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Xe=null,Ye=S.createElement("form"),Ve=function(e){try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},Ke=function(e){return be.call(e.ownerDocument||e,e,ue.SHOW_ELEMENT|ue.SHOW_COMMENT|ue.SHOW_TEXT,(function(){return ue.FILTER_ACCEPT}),!1)},Ge=function(e){var t,i,a;if(nt("beforeSanitizeElements",e,null),!((a=e)instanceof he||a instanceof me||"string"==typeof a.nodeName&&"string"==typeof a.textContent&&"function"==typeof a.removeChild&&a.attributes instanceof fe&&"function"==typeof a.removeAttribute&&"function"==typeof a.setAttribute))return Ve(e),!0;if(t=e.nodeName.toLowerCase(),nt("uponSanitizeElement",e,{tagName:t}),!Se[t]||Ae[t]){if(Ze&&!He[t]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return Ve(e),!0}return!Le||e.firstElementChild||e.content&&e.content.firstElementChild||(e.innerHTML=e.textContent.replace(/</g,"&lt;")),Ue&&3===e.nodeType&&(i=(i=(i=e.textContent).replace($e," ")).replace(Re," "),e.textContent=i),nt("afterSanitizeElements",e,null),!1},Je=/^data-[\w.\u00B7-\uFFFF-]/,Qe=/^(?:(?:(?:f|ht)tps?|mailto|tel):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,et=/^(?:\w+script|data):/i,tt=/[\x00-\x20\xA0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,it=function(e){var t,i,a,n,r,o,l,s;if(nt("beforeSanitizeAttributes",e,null),o=e.attributes){for(l={attrName:"",attrValue:"",keepAttr:!0},s=o.length;s--;)if(i=(t=o[s]).name,a=t.value,n=i.toLowerCase(),l.attrName=n,l.attrValue=a,l.keepAttr=!0,nt("uponSanitizeAttribute",e,l),a=l.attrValue,"name"===n&&"IMG"===e.nodeName&&o.id?(r=o.id,o=Array.prototype.slice.apply(o),e.removeAttribute("id"),e.removeAttribute(i),o.indexOf(r)>s&&e.setAttribute("id",r.value)):("id"===i&&e.setAttribute(i,""),e.removeAttribute(i)),l.keepAttr&&(!Ne||"id"!==n&&"name"!==n||!(a in window||a in S||a in Ye))&&(Ue&&(a=(a=a.replace($e," ")).replace(Re," ")),De[n]&&!Pe[n]&&(qe[n]||Qe.test(a.replace(tt,""))||"src"===n&&0===a.indexOf("data:")&&We[e.nodeName.toLowerCase()])||Ie&&Je.test(n)||ze&&!et.test(a.replace(tt,""))))try{e.setAttribute(i,a)}catch(e){}nt("afterSanitizeAttributes",e,null)}},at=function(e){var t,i=Ke(e);for(nt("beforeSanitizeShadowDOM",e,null);t=i.nextNode();)nt("uponSanitizeShadowNode",t,null),Ge(t)||(t.content instanceof ce&&at(t.content),it(t));nt("afterSanitizeShadowDOM",e,null)},nt=function(e,t,i){xe[e]&&xe[e].forEach((function(e){e.call(se,t,i,Xe)}))};se.sanitize=function(e,t){var i,a,n,r,o;if(e||(e=""),"string"!=typeof e){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");e=e.toString()}if(!se.isSupported)return"object"==typeof window.toStaticHTML||"function"==typeof window.toStaticHTML?window.toStaticHTML(e):e;if(function(e){"object"!=typeof e&&(e={}),Se="ALLOWED_TAGS"in e?Te({},e.ALLOWED_TAGS):ke,De="ALLOWED_ATTR"in e?Te({},e.ALLOWED_ATTR):Fe,Ae="FORBID_TAGS"in e?Te({},e.FORBID_TAGS):{},Pe="FORBID_ATTR"in e?Te({},e.FORBID_ATTR):{},Ie=!1!==e.ALLOW_DATA_ATTR,ze=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Le=e.SAFE_FOR_JQUERY||!1,Ue=e.SAFE_FOR_TEMPLATES||!1,je=e.WHOLE_DOCUMENT||!1,Be=e.RETURN_DOM||!1,Oe=e.RETURN_DOM_FRAGMENT||!1,Me=e.RETURN_DOM_IMPORT||!1,Ne=!1!==e.SANITIZE_DOM,Ze=!1!==e.KEEP_CONTENT,Ue&&(Ie=!1),Oe&&(Be=!0),e.ADD_TAGS&&(Se===ke&&(Se=Ee(Se)),Te(Se,e.ADD_TAGS)),e.ADD_ATTR&&(De===Fe&&(De=Ee(De)),Te(De,e.ADD_ATTR)),Ze&&(Se["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(e),Xe=e}(t),!Be&&!je&&-1===e.indexOf("<"))return e;if(i=function(e){var t,i;try{t=(new ge).parseFromString(e,"text/html")}catch(e){}return t||((i=(t=we.createHTMLDocument("")).body).parentNode.removeChild(i.parentNode.firstElementChild),i.outerHTML=e),"function"==typeof t.getElementsByTagName?t.getElementsByTagName(je?"html":"body")[0]:_e.call(t,je?"html":"body")[0]}(e),!i)return Be?null:"";for(r=Ke(i);a=r.nextNode();)3===a.nodeType&&a===n||Ge(a)||(a.content instanceof ce&&at(a.content),it(a),n=a);if(Be){if(Oe)for(o=ye.call(i.ownerDocument);i.firstChild;)o.appendChild(i.firstChild);else o=i;return Me&&(o=Ce.call(de,o,!0)),o}return je?i.outerHTML:i.innerHTML},se.addHook=function(e,t){"function"==typeof t&&(xe[e]=xe[e]||[],xe[e].push(t))},se.removeHook=function(e){xe[e]&&xe[e].pop()},se.removeHooks=function(e){xe[e]&&(xe[e]=[])},se.removeAllHooks=function(){xe=[]}}));